<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.306">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="phonchi">
<meta name="dcterms.date" content="2028-04-28">

<title>Computer Programming - 9&nbsp; Array-Oriented Programming with NumPy</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./12_Matplotlib.html" rel="next">
<link href="./08_09_OOP.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./10_11_NumPy.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Array-Oriented Programming with NumPy</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Computer Programming</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Python Basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Flow_control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Flow Control</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Lists_tuples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Lists and Tuples</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Dictionaries_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Other collections - Dictionaries and Sets</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Manipulating_string.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Manipulating Strings</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_Files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Files and Exceptions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_09_OOP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Object Oriented Programming and Classes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_11_NumPy.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Array-Oriented Programming with NumPy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_Matplotlib.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Visualization with <code>Matplotlib</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_SymPy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Symbolic Mathematics in Python with <code>SymPy</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_Copilot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Increase productivity and learning with Github Copilot in Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_SciPy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">High-level scientific computing with <code>SciPy</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Algorithms_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Algorithms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Data_Structure_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Data Structure</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Abstract_data_types_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Abstract Data Types</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 1_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Assignment 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 2_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Assignment 2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 3_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Assignment 3</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 4_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Assignment 4</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 5_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Assignment 5</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 6_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Assignment 6</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 7_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Assignment 7</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 8_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">M</span>&nbsp; <span class="chapter-title">Assignment 8</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 9_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">N</span>&nbsp; <span class="chapter-title">Assignment 9</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Quiz1_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">O</span>&nbsp; <span class="chapter-title">Quiz 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Quiz2_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">P</span>&nbsp; <span class="chapter-title">Quiz 2</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">9.1</span> Introduction</a></li>
  <li><a href="#creating-array-from-existing-data-constructor" id="toc-creating-array-from-existing-data-constructor" class="nav-link" data-scroll-target="#creating-array-from-existing-data-constructor"><span class="header-section-number">9.2</span> Creating <code>array</code> from Existing Data (Constructor)</a>
  <ul>
  <li><a href="#creating-array-using-from-fix-sequence" id="toc-creating-array-using-from-fix-sequence" class="nav-link" data-scroll-target="#creating-array-using-from-fix-sequence"><span class="header-section-number">9.2.1</span> Creating <code>array</code> using from fix sequence</a></li>
  <li><a href="#multidimensional-arguments" id="toc-multidimensional-arguments" class="nav-link" data-scroll-target="#multidimensional-arguments"><span class="header-section-number">9.2.2</span> Multidimensional Arguments</a>
  <ul class="collapse">
  <li><a href="#array-attributes" id="toc-array-attributes" class="nav-link" data-scroll-target="#array-attributes"><span class="header-section-number">9.2.2.1</span> <code>array</code> Attributes</a></li>
  </ul></li>
  <li><a href="#filling-array-with-specific-values" id="toc-filling-array-with-specific-values" class="nav-link" data-scroll-target="#filling-array-with-specific-values"><span class="header-section-number">9.2.3</span> Filling <code>array</code> with Specific Values</a></li>
  <li><a href="#creating-array-from-sequence-generated-by-different-methods" id="toc-creating-array-from-sequence-generated-by-different-methods" class="nav-link" data-scroll-target="#creating-array-from-sequence-generated-by-different-methods"><span class="header-section-number">9.2.4</span> Creating <code>array</code> from sequence generated by different methods</a>
  <ul class="collapse">
  <li><a href="#creating-sequence-with-fix-step-by-arange" id="toc-creating-sequence-with-fix-step-by-arange" class="nav-link" data-scroll-target="#creating-sequence-with-fix-step-by-arange"><span class="header-section-number">9.2.4.1</span> Creating sequence with fix step by <code>arange()</code></a></li>
  <li><a href="#creating-sequence-with-fix-sample-number-by-linspace" id="toc-creating-sequence-with-fix-sample-number-by-linspace" class="nav-link" data-scroll-target="#creating-sequence-with-fix-sample-number-by-linspace"><span class="header-section-number">9.2.4.2</span> Creating sequence with fix sample number by <code>linspace()</code></a></li>
  <li><a href="#reshaping-an-array" id="toc-reshaping-an-array" class="nav-link" data-scroll-target="#reshaping-an-array"><span class="header-section-number">9.2.4.3</span> Reshaping an <code>array</code></a></li>
  </ul></li>
  <li><a href="#list-vs.-array-performance-introducing-timeit" id="toc-list-vs.-array-performance-introducing-timeit" class="nav-link" data-scroll-target="#list-vs.-array-performance-introducing-timeit"><span class="header-section-number">9.2.5</span> <code>List</code> vs.&nbsp;<code>array</code> Performance: Introducing <code>%timeit</code></a></li>
  </ul></li>
  <li><a href="#indexing-and-slicing-getter-and-setter" id="toc-indexing-and-slicing-getter-and-setter" class="nav-link" data-scroll-target="#indexing-and-slicing-getter-and-setter"><span class="header-section-number">9.3</span> Indexing and Slicing (Getter and Setter)</a>
  <ul>
  <li><a href="#views-shallow-copies" id="toc-views-shallow-copies" class="nav-link" data-scroll-target="#views-shallow-copies"><span class="header-section-number">9.3.1</span> Views: Shallow Copies</a></li>
  <li><a href="#deep-copies" id="toc-deep-copies" class="nav-link" data-scroll-target="#deep-copies"><span class="header-section-number">9.3.2</span> Deep Copies</a></li>
  <li><a href="#more-about-reshaping-and-transposing" id="toc-more-about-reshaping-and-transposing" class="nav-link" data-scroll-target="#more-about-reshaping-and-transposing"><span class="header-section-number">9.3.3</span> More about Reshaping and Transposing</a></li>
  </ul></li>
  <li><a href="#numpy-calculation-methods-reduction" id="toc-numpy-calculation-methods-reduction" class="nav-link" data-scroll-target="#numpy-calculation-methods-reduction"><span class="header-section-number">9.4</span> <code>NumPy</code> calculation methods (Reduction)</a>
  <ul>
  <li><a href="#calculations-by-row-or-column" id="toc-calculations-by-row-or-column" class="nav-link" data-scroll-target="#calculations-by-row-or-column"><span class="header-section-number">9.4.1</span> Calculations by Row or Column</a></li>
  </ul></li>
  <li><a href="#array-operators" id="toc-array-operators" class="nav-link" data-scroll-target="#array-operators"><span class="header-section-number">9.5</span> <code>array</code> Operators</a>
  <ul>
  <li><a href="#the-slowness-of-loops" id="toc-the-slowness-of-loops" class="nav-link" data-scroll-target="#the-slowness-of-loops"><span class="header-section-number">9.5.1</span> The slowness of loops</a>
  <ul class="collapse">
  <li><a href="#element-wise-arithmetic" id="toc-element-wise-arithmetic" class="nav-link" data-scroll-target="#element-wise-arithmetic"><span class="header-section-number">9.5.1.1</span> Element-wise arithmetic</a></li>
  </ul></li>
  <li><a href="#broadcasting" id="toc-broadcasting" class="nav-link" data-scroll-target="#broadcasting"><span class="header-section-number">9.5.2</span> Broadcasting</a>
  <ul class="collapse">
  <li><a href="#arithmetic-operations-between-arrays" id="toc-arithmetic-operations-between-arrays" class="nav-link" data-scroll-target="#arithmetic-operations-between-arrays"><span class="header-section-number">9.5.2.1</span> Arithmetic Operations Between <code>arrays</code></a></li>
  <li><a href="#rules-of-broadcasting" id="toc-rules-of-broadcasting" class="nav-link" data-scroll-target="#rules-of-broadcasting"><span class="header-section-number">9.5.2.2</span> Rules of Broadcasting</a></li>
  <li><a href="#comparing-arrays" id="toc-comparing-arrays" class="nav-link" data-scroll-target="#comparing-arrays"><span class="header-section-number">9.5.2.3</span> Comparing arrays</a></li>
  </ul></li>
  <li><a href="#universal-functions-vectorization" id="toc-universal-functions-vectorization" class="nav-link" data-scroll-target="#universal-functions-vectorization"><span class="header-section-number">9.5.3</span> Universal Functions (Vectorization)</a>
  <ul class="collapse">
  <li><a href="#exploring-numpys-ufuncs" id="toc-exploring-numpys-ufuncs" class="nav-link" data-scroll-target="#exploring-numpys-ufuncs"><span class="header-section-number">9.5.3.1</span> Exploring <code>NumPy</code>’s <code>Ufuncs</code></a></li>
  <li><a href="#broadcasting-with-universal-functions" id="toc-broadcasting-with-universal-functions" class="nav-link" data-scroll-target="#broadcasting-with-universal-functions"><span class="header-section-number">9.5.3.2</span> Broadcasting with Universal Functions</a></li>
  <li><a href="#create-our-own-vectorizing-functions" id="toc-create-our-own-vectorizing-functions" class="nav-link" data-scroll-target="#create-our-own-vectorizing-functions"><span class="header-section-number">9.5.3.3</span> Create our own vectorizing functions</a></li>
  </ul></li>
  <li><a href="#type-casting" id="toc-type-casting" class="nav-link" data-scroll-target="#type-casting"><span class="header-section-number">9.5.5</span> Type casting</a></li>
  </ul></li>
  <li><a href="#file-io" id="toc-file-io" class="nav-link" data-scroll-target="#file-io"><span class="header-section-number">9.6</span> File I/O</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Array-Oriented Programming with NumPy</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>phonchi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 28, 2028</p>
    </div>
  </div>
  
    
  </div>
  

</header>


<table align="left">
<tbody><tr><td>
<a href="https://colab.research.google.com/github/phonchi/nsysu-math106A/blob/master/static_files/presentations/10_11_NumPy.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a>
</td>
<td>
<a target="_blank" href="https://kaggle.com/kernels/welcome?src=https://github.com/phonchi/nsysu-math106A/blob/master/static_files/presentations/10_11_NumPy.ipynb"><img src="https://kaggle.com/static/images/open-in-kaggle.svg"></a>
</td>

</tr></tbody></table>
<p><br></p>
<section id="introduction" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">9.1</span> Introduction</h2>
<p>The <code>NumPy</code> (Numerical Python) library first appeared in 2006 and is the preferred Python array implementation. It offers a high-performance, richly functional n-dimensional array type called <code>array.</code> Operations on arrays are up to one or two orders of magnitude faster than those on <code>lists</code>.</p>
<p>In this chapter, we explore the array’s basic capabilities. The built-in lists can have multiple dimensions, and you generally process multi-dimensional lists with nested loops or list comprehensions with multiple clauses. A strength of <code>NumPy</code> is “array-oriented programming,” <strong>which uses functional-style programming with internal iteration to make array manipulations concise and straightforward</strong>, eliminating the kinds of bugs that can occur with explicitly programmed loops.</p>
<p>In <code>Python</code> the types are dynamically inferred and we do not have to allocate the memory by ourselves. This type of flexibility also points to the fact that <code>Python</code> variables are more than just their values; they also contain extra information about the type and the size of the value:</p>
<center>
<img src="https://jakevdp.github.io/PythonDataScienceHandbook/figures/cint_vs_pyint.png">
</center>
<div data-align="center">
source: https://jakevdp.github.io/PythonDataScienceHandbook/figures/cint_vs_pyint.png
</div>
<p>Similarly, the <code>list</code> in <code>Python</code> is very flexible that can store heterogeneous objects. But this flexibility comes at a cost: to allow these flexible types, each item in the list must contain its type, size, and other information. Every element is a complete <code>Python</code> object. In the special case that all variables are of the same type, <strong>much of this information is redundant</strong>, so storing the data in a fixed-type array can be much more efficient. The difference between a dynamic-type list and a fixed-type (<code>NumPy</code>-style) array is illustrated:</p>
<center>
<img src="https://jakevdp.github.io/PythonDataScienceHandbook/figures/array_vs_list.png" width="70%" height="70%">
</center>
<div data-align="center">
source: https://jakevdp.github.io/PythonDataScienceHandbook/figures/array_vs_list.png
</div>
<p>At the implementation level, the <code>array</code> essentially contains a single pointer to one contiguous block of data. The <code>Python</code> <code>list</code>, on the other hand, includes a pointer to a block of pointers, each of which in turn points to a whole <code>Python</code> object like the <code>Python</code> integer we saw earlier.</p>
<blockquote class="blockquote">
<p>The advantage of the <code>list</code> is flexibility: because each list element is a full structure containing both data and type information, the list can be filled with data of any desired type. Fixed-type <code>NumPy</code>-style arrays lack this flexibility but are much more efficient for storing and manipulating data.</p>
</blockquote>
<p>From the previous lecture, we know that every object consists of data and methods. The <code>ndarray</code> object of the <code>NumPy</code> package not only provides efficient storage of array-based data but adds to this <strong>efficient operations</strong> on that data.</p>
</section>
<section id="creating-array-from-existing-data-constructor" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="creating-array-from-existing-data-constructor"><span class="header-section-number">9.2</span> Creating <code>array</code> from Existing Data (Constructor)</h2>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a>package_name <span class="op">=</span> <span class="st">"numpy"</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="cf">try</span>:</span>
<span id="cb1-4"><a href="#cb1-4"></a>    <span class="bu">__import__</span>(package_name)</span>
<span id="cb1-5"><a href="#cb1-5"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>package_name<span class="sc">}</span><span class="ss"> is already installed."</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="cf">except</span> <span class="pp">ImportError</span>:</span>
<span id="cb1-7"><a href="#cb1-7"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>package_name<span class="sc">}</span><span class="ss"> not found. Installing..."</span>)</span>
<span id="cb1-8"><a href="#cb1-8"></a>    <span class="op">%</span>pip install {package_name}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>numpy is already installed.</code></pre>
</div>
</div>
<p>The <code>NumPy</code> documentation recommends importing the <code>numpy</code> module as <code>np</code> so that you can access its members with “<code>np.</code>”</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1668686223113,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="6fac1a14-1607-409b-c6f1-0b05188f6e2c" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="creating-array-using-from-fix-sequence" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="creating-array-using-from-fix-sequence"><span class="header-section-number">9.2.1</span> Creating <code>array</code> using from fix sequence</h3>
<p>The <code>numpy</code> module provides various functions for creating arrays. Here we use the <code>array()</code> function, which receives a collection of elements and returns a new array containing the argument’s elements. Let’s pass a <code>list</code> for example:</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>numbers <span class="op">=</span> np.array([<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">11</span>])</span>
<span id="cb4-2"><a href="#cb4-2"></a>numbers, <span class="bu">type</span>(numbers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>(array([ 2,  3,  5,  7, 11]), numpy.ndarray)</code></pre>
</div>
</div>
<p>The <code>array()</code> function copies its argument’s contents into the <code>array</code>. Note that the type is <code>numpy.ndarray</code>, but all arrays are output as “array.”</p>
</section>
<section id="multidimensional-arguments" class="level3" data-number="9.2.2">
<h3 data-number="9.2.2" class="anchored" data-anchor-id="multidimensional-arguments"><span class="header-section-number">9.2.2</span> Multidimensional Arguments</h3>
<p>The <code>array()</code> function copies its argument’s dimensions. Let’s create an <code>array</code> from a two-row-by-three-column <code>list</code>:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]]), <span class="bu">type</span>(np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>(array([[1, 2, 3],
        [4, 5, 6]]),
 numpy.ndarray)</code></pre>
</div>
</div>
<section id="array-attributes" class="level4" data-number="9.2.2.1">
<h4 data-number="9.2.2.1" class="anchored" data-anchor-id="array-attributes"><span class="header-section-number">9.2.2.1</span> <code>array</code> Attributes</h4>
<p>The <code>array</code> function determines an array’s element type from its argument’s elements. You can check the element type with an array’s <code>dtype</code> attribute:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>integers <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb8-2"><a href="#cb8-2"></a>floats <span class="op">=</span> np.array([<span class="fl">0.0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>])</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a>integers.dtype, floats.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>(dtype('int32'), dtype('float64'))</code></pre>
</div>
</div>
<p>As you’ll see in the next section, various array-creation functions receive a <code>dtype</code> keyword argument so you can specify an array’s element type.</p>
<p>For performance reasons, <code>NumPy</code> is written in the C programming language and uses C’s data types. By default, <code>NumPy</code> stores integers as the <code>NumPy</code> type <code>int_</code> values — which correspond to 32-bit (4-byte) integers in C (this may be platform-dependent) — and stores floating-point numbers as the NumPy type <code>float64</code> values — which correspond to 64-bit (8-byte) floating-point values (double) in C. In our examples, most commonly, you’ll see the types <code>int32</code>, <code>float64</code> and <code>bool</code> for non-numeric data (such as strings). The complete list of supported types is at <a href="https://docs.scipy.org/doc/numpy/user/basics.types.html">https://docs.scipy.org/doc/numpy/user/basics.types.html</a>.</p>
<p>The attribute <code>ndim</code> contains an array’s number of dimensions and the attribute <code>shape</code> contains a tuple specifying an array’s dimensions:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="bu">print</span>(integers.ndim)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="bu">print</span>(floats.ndim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2
1</code></pre>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="bu">print</span>(integers.shape)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="bu">print</span>(floats.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(2, 3)
(5,)</code></pre>
</div>
</div>
<p>Here, integers have 2 rows and 3 columns (6 elements) and floats are one-dimensional, containing 5 floating numbers.</p>
<p>You can view an array’s total number of elements with the attribute <code>size</code> and the number of bytes required to store each element with <code>itemsize</code>:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="bu">print</span>(integers.size)</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="bu">print</span>(integers.itemsize)</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="bu">print</span>(floats.size)</span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="bu">print</span>(floats.itemsize)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>6
4
5
8</code></pre>
</div>
</div>
<p>Note that the integers’ size is the product of the shape tuple’s values — two rows of three elements each for a total of six elements. In each case, <code>itemsize</code> is 4 because integers contain <code>int32</code> values and 8 since floats contain <code>float64</code> values.</p>
</section>
</section>
<section id="filling-array-with-specific-values" class="level3" data-number="9.2.3">
<h3 data-number="9.2.3" class="anchored" data-anchor-id="filling-array-with-specific-values"><span class="header-section-number">9.2.3</span> Filling <code>array</code> with Specific Values</h3>
<p><code>NumPy</code> provides functions <code>zeros()</code>, <code>ones()</code> and <code>full()</code> for creating arrays containing 0s, 1s or a specified value, respectively. By default, <code>zeros()</code> and <code>ones()</code> create arrays containing <code>float64</code> values. We’ll show how to customize the element type momentarily. The first argument to these functions must be an integer or a tuple of integers specifying the desired dimensions. For an integer, each function returns a one-dimensional array with the specified number of elements:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>np.zeros(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>array([0., 0., 0., 0., 0.])</code></pre>
</div>
</div>
<p>For a tuple of integers, these functions return a multidimensional array with the specified dimensions. You can specify the array’s element type with the <code>zeros()</code> and <code>ones()</code> function’s <code>dtype</code> keyword argument:</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a>np.ones((<span class="dv">2</span>, <span class="dv">4</span>), dtype<span class="op">=</span>np.int64)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>array([[1, 1, 1, 1],
       [1, 1, 1, 1]], dtype=int64)</code></pre>
</div>
</div>
<p>The array returned by <code>full()</code> contains elements with the second argument’s value and type:</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a>np.full((<span class="dv">3</span>, <span class="dv">5</span>), <span class="dv">13</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>array([[13, 13, 13, 13, 13],
       [13, 13, 13, 13, 13],
       [13, 13, 13, 13, 13]])</code></pre>
</div>
</div>
</section>
<section id="creating-array-from-sequence-generated-by-different-methods" class="level3" data-number="9.2.4">
<h3 data-number="9.2.4" class="anchored" data-anchor-id="creating-array-from-sequence-generated-by-different-methods"><span class="header-section-number">9.2.4</span> Creating <code>array</code> from sequence generated by different methods</h3>
<section id="creating-sequence-with-fix-step-by-arange" class="level4" data-number="9.2.4.1">
<h4 data-number="9.2.4.1" class="anchored" data-anchor-id="creating-sequence-with-fix-step-by-arange"><span class="header-section-number">9.2.4.1</span> Creating sequence with fix step by <code>arange()</code></h4>
<p>Let’s use <code>NumPy</code>’s <code>arange</code> function to create integer ranges — similar to using the built-in function <code>range</code>. In each case, <code>arange</code> first determines the resulting array’s number of elements, allocates the memory, then stores the specified range of values in the array:</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>np.arange(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>array([0, 1, 2, 3, 4])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a>np.arange(<span class="dv">5</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>array([5, 6, 7, 8, 9])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>np.arange(<span class="dv">10</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>array([10,  8,  6,  4,  2])</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>It is the same as <code>range()</code> which takes three arguments <code>numpy.arange(start, stop, step)</code></p>
</blockquote>
</section>
<section id="creating-sequence-with-fix-sample-number-by-linspace" class="level4" data-number="9.2.4.2">
<h4 data-number="9.2.4.2" class="anchored" data-anchor-id="creating-sequence-with-fix-sample-number-by-linspace"><span class="header-section-number">9.2.4.2</span> Creating sequence with fix sample number by <code>linspace()</code></h4>
<p>You can produce evenly spaced floating-point ranges with <code>NumPy</code>’s <code>linspace()</code> function. The function’s first two arguments specify the starting and ending values in the range, <strong>and the ending value is included in the array</strong>. The optional keyword argument <code>num</code> specifies the number of evenly spaced values to produce:</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a>np.linspace(<span class="fl">0.0</span>, <span class="fl">1.0</span>, num<span class="op">=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>array([0.  , 0.25, 0.5 , 0.75, 1.  ])</code></pre>
</div>
</div>
</section>
<section id="reshaping-an-array" class="level4" data-number="9.2.4.3">
<h4 data-number="9.2.4.3" class="anchored" data-anchor-id="reshaping-an-array"><span class="header-section-number">9.2.4.3</span> Reshaping an <code>array</code></h4>
<p>You also can create an <code>array</code> from a range of elements, then use the array method <code>reshape()</code> to transform the one-dimensional array into a multidimensional array. Let’s create an <code>array</code> containing the values from 1 through 20, then reshape it into four rows by five columns:</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a>np.arange(<span class="dv">1</span>, <span class="dv">21</span>).reshape(<span class="dv">4</span>, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>array([[ 1,  2,  3,  4,  5],
       [ 6,  7,  8,  9, 10],
       [11, 12, 13, 14, 15],
       [16, 17, 18, 19, 20]])</code></pre>
</div>
</div>
<p>Note the <strong><em>chained method</em></strong> calls in the preceding snippet. First, <code>arange</code> produces an array containing the values 1–20. Then we call <code>reshape()</code> on that array to get the 4-by-5 array that was displayed. You can <code>reshape()</code> any array, provided that the new shape has the same number of elements as the original. So a six-element one-dimensional array can become a 3-by-2 or 2-by-3 array, and vice versa!</p>
</section>
</section>
<section id="list-vs.-array-performance-introducing-timeit" class="level3" data-number="9.2.5">
<h3 data-number="9.2.5" class="anchored" data-anchor-id="list-vs.-array-performance-introducing-timeit"><span class="header-section-number">9.2.5</span> <code>List</code> vs.&nbsp;<code>array</code> Performance: Introducing <code>%timeit</code></h3>
<p>Most <code>array</code> operations execute significantly faster than corresponding <code>list</code> operations. To demonstrate, we’ll use the <code>%timeit</code> magic command, which times the average duration of operations.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a><span class="im">import</span> random</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, let’s use the <code>random</code> module’s <code>randint()</code> function with a list comprehension to create a list of six million die rolls and time the operation using <code>%timeit</code>:</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a><span class="op">%</span>timeit rolls_list <span class="op">=</span> [random.randint(<span class="dv">1</span>, <span class="dv">6</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">6_000_000</span>)] <span class="co">#_ is use to separate long integer</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.67 s ± 15.6 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>By default, <code>%timeit</code> executes a statement in a loop, and it runs the loop seven times. If you do not indicate the number of loops, <code>%timeit</code> chooses an appropriate value.</p>
</blockquote>
<p>Now, let’s use the <code>randint()</code> function from the <code>numpy.random</code> module to create an array</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a><span class="op">%</span>timeit rolls_array <span class="op">=</span> np.random.randint(<span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">6_000_000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>42 ms ± 805 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
</div>
</div>
</section>
</section>
<section id="indexing-and-slicing-getter-and-setter" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="indexing-and-slicing-getter-and-setter"><span class="header-section-number">9.3</span> Indexing and Slicing (Getter and Setter)</h2>
<p>One-dimensional arrays can be indexed and sliced using the same syntax and techniques demonstrated in the “Lists and Tuples” chapter. Here, we focus on array-specific indexing and slicing capabilities.</p>
<p>To select an element in a two-dimensional array, specify a tuple containing the element’s row and column indices in square brackets:</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a>grades <span class="op">=</span> np.array([[<span class="dv">87</span>, <span class="dv">96</span>, <span class="dv">70</span>], [<span class="dv">100</span>, <span class="dv">87</span>, <span class="dv">90</span>],</span>
<span id="cb37-2"><a href="#cb37-2"></a>                   [<span class="dv">94</span>, <span class="dv">77</span>, <span class="dv">90</span>], [<span class="dv">100</span>, <span class="dv">81</span>, <span class="dv">82</span>]])</span>
<span id="cb37-3"><a href="#cb37-3"></a>grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>array([[ 87,  96,  70],
       [100,  87,  90],
       [ 94,  77,  90],
       [100,  81,  82]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a>grades[<span class="dv">0</span>, <span class="dv">1</span>]  <span class="co"># row 0, column 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>96</code></pre>
</div>
</div>
<p>To select a single row, specify only one index in square brackets:</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a>grades[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>array([100,  87,  90])</code></pre>
</div>
</div>
<p>To select multiple sequential rows, use slice notation:</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a>grades[<span class="dv">0</span>:<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>array([[ 87,  96,  70],
       [100,  87,  90]])</code></pre>
</div>
</div>
<p>To select multiple non-sequential rows, use a list of row indices (fancy indexing):</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a>grades[[<span class="dv">1</span>, <span class="dv">3</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>array([[100,  87,  90],
       [100,  81,  82]])</code></pre>
</div>
</div>
<p>Let’s select only the elements in the first column:</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a>grades[:, <span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>array([ 87, 100,  94, 100])</code></pre>
</div>
</div>
<p>The 0 after the comma indicates that we’re selecting only column 0. The <code>:</code> before the comma indicates which rows within that column to select. <strong>In this case, <code>:</code> is a slice representing all rows</strong>. You can select consecutive columns using a slice:</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a>grades[:, <span class="dv">1</span>:<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>array([[96, 70],
       [87, 90],
       [77, 90],
       [81, 82]])</code></pre>
</div>
</div>
<p>or specific columns using a list of column indices:</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a>grades[:, [<span class="dv">0</span>, <span class="dv">2</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>array([[ 87,  70],
       [100,  90],
       [ 94,  90],
       [100,  82]])</code></pre>
</div>
</div>
<p><code>array</code> is mutable. Therefore, if we want to modify the value of the array, we can use the previous method and put the result on the left-hand side:</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1"></a>grades[<span class="dv">3</span>, <span class="dv">2</span>] <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb53-2"><a href="#cb53-2"></a>grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>array([[ 87,  96,  70],
       [100,  87,  90],
       [ 94,  77,  90],
       [100,  81,  42]])</code></pre>
</div>
</div>
<section id="views-shallow-copies" class="level3" data-number="9.3.1">
<h3 data-number="9.3.1" class="anchored" data-anchor-id="views-shallow-copies"><span class="header-section-number">9.3.1</span> Views: Shallow Copies</h3>
<p><strong><em>Views</em></strong> are objects “see” the data in other objects, rather than having their own copies of the data. Views are also known as <strong><em>shallow copies</em></strong>. Various <code>array</code> methods and slicing operations produce views of an array’s data. The <code>array</code> method <code>view()</code> returns a new array object with a view of the original array object’s data. First, let’s create an array and a view of that array:</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1"></a>numbers <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">6</span>)</span>
<span id="cb55-2"><a href="#cb55-2"></a>numbers2 <span class="op">=</span> numbers.view()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can use the built-in <code>id()</code> function to see that <code>numbers</code> and <code>numbers2</code> are different objects:</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1"></a><span class="bu">id</span>(numbers), <span class="bu">id</span>(numbers2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>(1664107572080, 1664073164144)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1"></a>np.shares_memory(numbers, numbers2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>True</code></pre>
</div>
</div>
<p><strong>To prove that <code>numbers2</code> views the same data as <code>numbers</code></strong>, let’s modify an element in <code>numbers</code>, then display both arrays:</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1"></a>numbers[<span class="dv">1</span>] <span class="op">*=</span> <span class="dv">10</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>numbers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>array([ 1, 20,  3,  4,  5])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1"></a>numbers2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>array([ 1, 20,  3,  4,  5])</code></pre>
</div>
</div>
<p>Similarly, changing a value in the view also changes that value in the original array:</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1"></a>numbers2[<span class="dv">1</span>] <span class="op">/=</span> <span class="dv">5</span></span>
<span id="cb64-2"><a href="#cb64-2"></a>numbers, numbers2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>(array([1, 4, 3, 4, 5]), array([1, 4, 3, 4, 5]))</code></pre>
</div>
</div>
<p>Slices also create views. Let’s make <code>numbers2</code> a slice that views only the first three elements of numbers:</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1"></a>numbers2 <span class="op">=</span> numbers[<span class="dv">0</span>:<span class="dv">3</span>]</span>
<span id="cb66-2"><a href="#cb66-2"></a>numbers2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>array([1, 4, 3])</code></pre>
</div>
</div>
<p>Again, we can confirm that <code>numbers</code> and <code>numbers2</code> are different objects with <code>id()</code>:</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1"></a><span class="bu">id</span>(numbers), <span class="bu">id</span>(numbers2), np.shares_memory(numbers, numbers2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>(1664107572080, 1664107667152, True)</code></pre>
</div>
</div>
<p>Now, let’s modify an element both arrays share, then display them. Again, we see that <code>numbers2</code> is a view of <code>numbers</code>:</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1"></a>numbers[<span class="dv">1</span>] <span class="op">*=</span> <span class="dv">20</span></span>
<span id="cb70-2"><a href="#cb70-2"></a>numbers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>array([ 1, 80,  3,  4,  5])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1"></a>numbers2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>array([ 1, 80,  3])</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Note that this behavior is different from <code>list</code>, where the slicing will create a new sub <code>list</code>!</p>
</blockquote>
</section>
<section id="deep-copies" class="level3" data-number="9.3.2">
<h3 data-number="9.3.2" class="anchored" data-anchor-id="deep-copies"><span class="header-section-number">9.3.2</span> Deep Copies</h3>
<p>Though views are separate <code>array</code> objects, they save memory by sharing element data from other arrays. However, when sharing mutable values, sometimes creating a <strong><em>deep copy</em></strong> with independent copies of the original data is necessary. This is especially important in multi-core programming, where separate parts of your program could attempt to modify your data at the same time, possibly corrupting it.</p>
<p>The <code>array</code> method <code>copy()</code> returns a new array object with a deep copy of the original array object’s data. First, let’s create an array and a deep copy of that array:</p>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1"></a>numbers <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">6</span>)</span>
<span id="cb74-2"><a href="#cb74-2"></a>numbers2 <span class="op">=</span> numbers.copy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1"></a><span class="bu">id</span>(numbers), <span class="bu">id</span>(numbers2), np.shares_memory(numbers, numbers2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>(1664107664944, 1664107665712, False)</code></pre>
</div>
</div>
<p>To prove that <code>numbers2</code> has a separate copy of the data in <code>numbers</code>, let’s modify an element in <code>numbers</code>, then display both arrays:</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1"></a>numbers[<span class="dv">1</span>] <span class="op">*=</span> <span class="dv">10</span></span>
<span id="cb77-2"><a href="#cb77-2"></a>numbers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>array([ 1, 20,  3,  4,  5])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1"></a>numbers2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>array([1, 2, 3, 4, 5])</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Recall that if you need deep copies of other types of <code>Python</code> objects, pass them to the <code>copy</code> module’s <code>deepcopy()</code> function.</p>
</blockquote>
</section>
<section id="more-about-reshaping-and-transposing" class="level3" data-number="9.3.3">
<h3 data-number="9.3.3" class="anchored" data-anchor-id="more-about-reshaping-and-transposing"><span class="header-section-number">9.3.3</span> More about Reshaping and Transposing</h3>
<p>We’ve used <code>array</code> method <code>reshape()</code> to produce two-dimensional arrays from one-dimensional <code>array</code>. <code>NumPy</code> provides various other ways to reshape <code>arrays</code>.</p>
<p>The array methods <code>reshape()</code> and <code>resize()</code> both enable you to change an array’s dimensions. Method <code>reshape()</code> returns a view (shallow copy) of the original array with the new dimensions. It does not modify the original array:</p>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1"></a>grades <span class="op">=</span> np.array([[<span class="dv">87</span>, <span class="dv">96</span>, <span class="dv">70</span>], [<span class="dv">100</span>, <span class="dv">87</span>, <span class="dv">90</span>]])</span>
<span id="cb81-2"><a href="#cb81-2"></a>grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>array([[ 87,  96,  70],
       [100,  87,  90]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1"></a>grades2 <span class="op">=</span> grades.reshape(<span class="dv">1</span>, <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1"></a>grades2[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb84-2"><a href="#cb84-2"></a>grades2, grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>(array([[  0,  96,  70, 100,  87,  90]]),
 array([[  0,  96,  70],
        [100,  87,  90]]))</code></pre>
</div>
</div>
<p>A common trick is that you can use <code>-1</code> to specify the shape in <code>resahpe()</code>. The length of the dimension set to <code>-1</code> is automatically determined by inferring from the specified values of other dimensions:</p>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1"></a>grades.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>) <span class="co"># Same as grades.reshape(3, 2)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>array([[  0,  96],
       [ 70, 100],
       [ 87,  90]])</code></pre>
</div>
</div>
<p>Method <code>resize()</code> modifies the original array’s shape in-place. It does not return a value:</p>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1"></a>grades.resize(<span class="dv">1</span>, <span class="dv">6</span>)</span>
<span id="cb88-2"><a href="#cb88-2"></a>grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>array([[  0,  96,  70, 100,  87,  90]])</code></pre>
</div>
</div>
<p>We can also do the opposite operation, which takes a multidimensional <code>array</code> and flatten it into a single dimension with the methods <code>flatten()</code> and <code>ravel()</code>. Method <code>flatten()</code> deep copies the original <code>array</code>’s data:</p>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1"></a>grades <span class="op">=</span> np.array([[<span class="dv">87</span>, <span class="dv">96</span>, <span class="dv">70</span>], [<span class="dv">100</span>, <span class="dv">87</span>, <span class="dv">90</span>]])</span>
<span id="cb90-2"><a href="#cb90-2"></a>grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>array([[ 87,  96,  70],
       [100,  87,  90]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1"></a>flattened <span class="op">=</span> grades.flatten()</span>
<span id="cb92-2"><a href="#cb92-2"></a>flattened</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>array([ 87,  96,  70, 100,  87,  90])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1"></a>flattened[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb94-2"><a href="#cb94-2"></a>grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>array([[ 87,  96,  70],
       [100,  87,  90]])</code></pre>
</div>
</div>
<p>Method <code>ravel()</code> produces a view of the original <code>array</code>, which shares the <code>grades</code> <code>array</code>’s data!</p>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1"></a>raveled <span class="op">=</span> grades.ravel()</span>
<span id="cb96-2"><a href="#cb96-2"></a>raveled</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>array([ 87,  96,  70, 100,  87,  90])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1"></a>raveled[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb98-2"><a href="#cb98-2"></a>grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>array([[100,  96,  70],
       [100,  87,  90]])</code></pre>
</div>
</div>
<p>Additionally, we can effortlessly transpose an <code>array</code>‘s rows and columns, causing the rows to turn into columns and the columns into rows. The <code>T</code> attribute returns a transposed view (shallow copy) of the array. Assume that the original <code>grades</code> <code>array</code> presents two students’ grades (the rows) across three exams (the columns). Let’s transpose the rows and columns to examine the data as the grades for three exams (the rows) taken by two students (the columns):</p>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1"></a>transpose <span class="op">=</span> grades.T</span>
<span id="cb100-2"><a href="#cb100-2"></a>transpose</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>array([[100, 100],
       [ 96,  87],
       [ 70,  90]])</code></pre>
</div>
</div>
<p>Transposing does not modify the original array but it does create a view of the original array’s data:</p>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1"></a>transpose[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb102-2"><a href="#cb102-2"></a>grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>array([[  0,  96,  70],
       [100,  87,  90]])</code></pre>
</div>
</div>
<p>You can combine arrays by adding more columns or more rows — known as horizontal stacking and vertical stacking. Let’s create another 2-by-3 array of grades:</p>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1"></a>grades2 <span class="op">=</span> np.array([[<span class="dv">94</span>, <span class="dv">77</span>, <span class="dv">90</span>], [<span class="dv">100</span>, <span class="dv">81</span>, <span class="dv">82</span>]])</span>
<span id="cb104-2"><a href="#cb104-2"></a>grades2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>array([[ 94,  77,  90],
       [100,  81,  82]])</code></pre>
</div>
</div>
<p>Let’s assume <code>grades2</code> represents three additional exam grades for the two students in the <code>grades</code> array. We can combine <code>grades</code> and <code>grades2</code> with <code>NumPy</code>’s <code>hstack()</code> (horizontal stack) function by passing a <code>tuple</code> containing the arrays to combine. The extra parentheses are required because <code>hstack()</code> expects one argument:</p>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1"></a>np.hstack((grades, grades2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>array([[  0,  96,  70,  94,  77,  90],
       [100,  87,  90, 100,  81,  82]])</code></pre>
</div>
</div>
<p>Next, let’s assume that <code>grades2</code> represents two more students’ grades on three exams. In this case, we can combine <code>grades</code> and <code>grades2</code> with <code>NumPy</code>’s <code>vstack()</code> (vertical stack) function:</p>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1"></a>np.vstack((grades, grades2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>array([[  0,  96,  70],
       [100,  87,  90],
       [ 94,  77,  90],
       [100,  81,  82]])</code></pre>
</div>
</div>
<blockquote class="blockquote">
<h3 id="exercise-1-suppose-we-are-developing-a-chess-game-and-the-chess-game-provide-two-special-checkerboards-as-follows" data-number="9.3.4" class="anchored"><span class="header-section-number">9.3.4</span> Exercise 1: Suppose we are developing a chess game and the chess game provide two special checkerboards as follows:</h3>
</blockquote>
<center>
<img src="https://drive.google.com/uc?id=1zAMarVoAZE2immDDiwo9JGQ2eGNkEVTJ" width="20%" height="20%">
</center>
<center>
<img src="https://drive.google.com/uc?id=1zA_3dLW7dJOFh9SaMVIsuGJo73JckWF7" width="40%" height="40%">
</center>
<p>We decide to use 1 to represent the white square and 0 to represent the black square. Write a program to create two 2D arrays to represent the two checkerboards as follows:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1"></a>[[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb110-2"><a href="#cb110-2"></a> [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb110-3"><a href="#cb110-3"></a> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb110-4"><a href="#cb110-4"></a> [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb110-5"><a href="#cb110-5"></a> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb110-6"><a href="#cb110-6"></a> [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb111"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1"></a>[[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb111-2"><a href="#cb111-2"></a> [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb111-3"><a href="#cb111-3"></a> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note you should not directly hardcode the above arrays. You should use <code>Numpy</code> methods to create the arrays. After you have finished the exercise, you can print out the checkerboard using the following code cell.</p>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1"></a><span class="co"># Your answer here</span></span>
<span id="cb112-2"><a href="#cb112-2"></a>checkerboard</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>array([[1., 0., 1., 0., 1., 0.],
       [0., 1., 0., 1., 0., 1.],
       [1., 0., 1., 0., 1., 0.],
       [0., 1., 0., 1., 0., 1.],
       [1., 0., 1., 0., 1., 0.],
       [0., 1., 0., 1., 0., 1.]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1"></a><span class="co"># Your answer here</span></span>
<span id="cb114-2"><a href="#cb114-2"></a>checkerboard2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>array([[1., 0., 1., 0., 1., 0., 0., 1., 0., 1., 0., 1.],
       [0., 1., 0., 1., 0., 1., 1., 0., 1., 0., 1., 0.],
       [1., 0., 1., 0., 1., 0., 0., 1., 0., 1., 0., 1.]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1"></a><span class="co"># Plot the checkerboard</span></span>
<span id="cb116-2"><a href="#cb116-2"></a>package_name <span class="op">=</span> <span class="st">"matplotlib"</span></span>
<span id="cb116-3"><a href="#cb116-3"></a></span>
<span id="cb116-4"><a href="#cb116-4"></a><span class="cf">try</span>:</span>
<span id="cb116-5"><a href="#cb116-5"></a>    <span class="bu">__import__</span>(package_name)</span>
<span id="cb116-6"><a href="#cb116-6"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>package_name<span class="sc">}</span><span class="ss"> is already installed."</span>)</span>
<span id="cb116-7"><a href="#cb116-7"></a><span class="cf">except</span> <span class="pp">ImportError</span>:</span>
<span id="cb116-8"><a href="#cb116-8"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>package_name<span class="sc">}</span><span class="ss"> not found. Installing..."</span>)</span>
<span id="cb116-9"><a href="#cb116-9"></a>    <span class="op">%</span>pip install {package_name}</span>
<span id="cb116-10"><a href="#cb116-10"></a></span>
<span id="cb116-11"><a href="#cb116-11"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb116-12"><a href="#cb116-12"></a>plt.imshow(checkerboard, cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb116-13"><a href="#cb116-13"></a>plt.show()</span>
<span id="cb116-14"><a href="#cb116-14"></a>plt.imshow(checkerboard2, cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>matplotlib is already installed.</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="10_11_NumPy_files/figure-html/cell-61-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="10_11_NumPy_files/figure-html/cell-61-output-3.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="numpy-calculation-methods-reduction" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="numpy-calculation-methods-reduction"><span class="header-section-number">9.4</span> <code>NumPy</code> calculation methods (Reduction)</h2>
<p>An <code>array</code> includes several methods that carry out computations based on its contents. <strong>By default, these methods disregard the array’s shape and utilize all the elements in the calculations.</strong> For instance, when computing the mean of an array, it sums all of its elements irrespective of its shape, and then divides by the total number of elements. <strong>We can also execute these calculations on each dimension.</strong> For example, in a two-dimensional array, we can determine the mean of each row and each column.</p>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1"></a>grades <span class="op">=</span> np.array([[<span class="dv">87</span>, <span class="dv">96</span>, <span class="dv">70</span>], [<span class="dv">100</span>, <span class="dv">87</span>, <span class="dv">90</span>],</span>
<span id="cb118-2"><a href="#cb118-2"></a>                   [<span class="dv">94</span>, <span class="dv">77</span>, <span class="dv">90</span>], [<span class="dv">100</span>, <span class="dv">81</span>, <span class="dv">82</span>]])</span>
<span id="cb118-3"><a href="#cb118-3"></a>grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">
<pre><code>array([[ 87,  96,  70],
       [100,  87,  90],
       [ 94,  77,  90],
       [100,  81,  82]])</code></pre>
</div>
</div>
<p>We can use methods to calculate <code>sum()</code>, <code>min()</code>, <code>max()</code>, <code>mean()</code>, <code>std()</code> (standard deviation) and <code>var()</code> (variance) — each is a functional-style programming reduction:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1"></a><span class="bu">print</span>(grades.<span class="bu">sum</span>())</span>
<span id="cb120-2"><a href="#cb120-2"></a><span class="bu">print</span>(grades.<span class="bu">min</span>())</span>
<span id="cb120-3"><a href="#cb120-3"></a><span class="bu">print</span>(grades.<span class="bu">max</span>())</span>
<span id="cb120-4"><a href="#cb120-4"></a><span class="bu">print</span>(grades.mean())</span>
<span id="cb120-5"><a href="#cb120-5"></a><span class="bu">print</span>(grades.std())</span>
<span id="cb120-6"><a href="#cb120-6"></a><span class="bu">print</span>(grades.var())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1054
70
100
87.83333333333333
8.792357792739987
77.30555555555556</code></pre>
</div>
</div>
<section id="calculations-by-row-or-column" class="level3" data-number="9.4.1">
<h3 data-number="9.4.1" class="anchored" data-anchor-id="calculations-by-row-or-column"><span class="header-section-number">9.4.1</span> Calculations by Row or Column</h3>
<p>Numerous calculation methods can be applied to specific <code>array</code> dimensions, referred to as the <code>array</code>’s <strong><em>axes</em></strong>. These methods accept an <code>axis</code> keyword argument that designates the dimension to be utilized in the calculation, providing a convenient means to perform computations by row or column in a two-dimensional <code>array</code>.</p>
<p>Suppose we want to find the maximum grade for each exam, represented by the columns of <code>grades</code>. By specifying <code>axis=0</code>, the calculation is performed on all the row values within each column:</p>
<div class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1"></a>grades, grades.<span class="bu">max</span>(axis<span class="op">=</span><span class="dv">0</span>), grades.argmax(axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">
<pre><code>(array([[ 87,  96,  70],
        [100,  87,  90],
        [ 94,  77,  90],
        [100,  81,  82]]),
 array([100,  96,  90]),
 array([1, 0, 1], dtype=int64))</code></pre>
</div>
</div>
<p>Here, 100 is the maximum value in the first column and its corresponding index (row) is 1 (if there are duplicate elements, the index of the first element will be reported). 96 and 90 are the maximum values in the second and third columns, respectively.</p>
<div class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1"></a>grades, grades.mean(axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>(array([[ 87,  96,  70],
        [100,  87,  90],
        [ 94,  77,  90],
        [100,  81,  82]]),
 array([95.25, 85.25, 83.  ]))</code></pre>
</div>
</div>
<p>Hence, 95.25 above represents the average of the first column’s grades (87, 100, 94, and 100), 85.25 is the average of the second column’s grades (96, 87, 77, and 81), and 83 is the average of the third column’s grades (70, 90, 90, and 82). Similarly, specifying <code>axis=1</code> performs the calculation on all the column values within each individual row. To determine each student’s average grade for all exams, we can use:</p>
<center>
<img src="https://drive.google.com/uc?id=1zKEtJG57FacKhqblKPuhnO61BBryYQy0" width="50%" height="50%">
</center>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1"></a>grades, grades.mean(axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">
<pre><code>(array([[ 87,  96,  70],
        [100,  87,  90],
        [ 94,  77,  90],
        [100,  81,  82]]),
 array([84.33333333, 92.33333333, 87.        , 87.66666667]))</code></pre>
</div>
</div>
<p>This generates four averages — one for the values in each row. Therefore, 84.33333333 is the average of row 0’s grades (87, 96, and 70), and the other averages correspond to the remaining rows. For more methods, refer to <a href="https://numpy.org/doc/stable/reference/arrays.ndarray.html">https://numpy.org/doc/stable/reference/arrays.ndarray.html</a>.</p>
<blockquote class="blockquote">
<p>For more operations such as methods related to linear algebra, we can use the sub-module <code>numpy.linalg</code>, which implements basic linear algebra, such as solving linear systems, singular value decomposition, etc. However, it is not guaranteed to be compiled using efficient routines, and thus we recommend the use of <code>scipy.linalg</code>, which will introduce in a later chapter.</p>
</blockquote>
</section>
</section>
<section id="array-operators" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="array-operators"><span class="header-section-number">9.5</span> <code>array</code> Operators</h2>
<section id="the-slowness-of-loops" class="level3" data-number="9.5.1">
<h3 data-number="9.5.1" class="anchored" data-anchor-id="the-slowness-of-loops"><span class="header-section-number">9.5.1</span> The slowness of loops</h3>
<p>The speed of computations on <code>NumPy</code> <code>arrays</code> can range from very fast to very slow. To optimize performance, the recommended approach is to use <strong><em>vectorized operations</em></strong>, which are typically implemented through <code>NumPy</code>’s universal functions (<code>ufuncs</code>). In scenarios that involve executing numerous small operations repeatedly, the inherent sluggishness of <code>Python</code> often becomes apparent. One such instance is when we loop over <code>arrays</code> to perform operations on each element. For example, suppose we have an array of values and need to compute the reciprocal of each value. A straightforward approach might involve:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1"></a><span class="kw">def</span> compute_reciprocals(values):</span>
<span id="cb128-2"><a href="#cb128-2"></a>    output <span class="op">=</span> np.empty(<span class="bu">len</span>(values))</span>
<span id="cb128-3"><a href="#cb128-3"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(values)):</span>
<span id="cb128-4"><a href="#cb128-4"></a>        output[i] <span class="op">=</span> <span class="fl">1.0</span> <span class="op">/</span> values[i]</span>
<span id="cb128-5"><a href="#cb128-5"></a>    <span class="cf">return</span> output</span>
<span id="cb128-6"><a href="#cb128-6"></a></span>
<span id="cb128-7"><a href="#cb128-7"></a>values <span class="op">=</span> np.random.randint(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">5</span>)</span>
<span id="cb128-8"><a href="#cb128-8"></a>compute_reciprocals(values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([0.11111111, 0.25      , 0.16666667, 0.14285714, 0.5       ])</code></pre>
</div>
</div>
<p>But if we measure the execution time of this code for a large input, we see that this operation is very slow:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1"></a>big_array <span class="op">=</span> np.random.randint(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1_000_000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1"></a><span class="op">%%</span>timeit </span>
<span id="cb131-2"><a href="#cb131-2"></a>compute_reciprocals(big_array)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.33 s ± 3.2 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Interestingly, the bottleneck in this situation isn’t the operations themselves, but rather the type checking and function dispatches that <code>Python</code> needs to execute during each iteration of the loop. Whenever the reciprocal is calculated, <code>Python</code> initially verifies the type of the object and performs a dynamic lookup to determine the correct function to employ for that type. If we were using compiled code, this kind of specification would be predetermined before the code execution, resulting in much more efficient computations.</p>
</blockquote>
<p>In <code>NumPy</code>, <strong><em>vectorization</em></strong> is the process of performing operations on entire <code>arrays</code> of data, as opposed to individual elements. This is accomplished by applying an operation to the entire <code>array</code>, instead of looping through each element of the <code>array</code> one at a time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1"></a><span class="fl">1.0</span> <span class="op">/</span> values <span class="co"># The vectorized version of the above code</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([0.11111111, 0.25      , 0.16666667, 0.14285714, 0.5       ])</code></pre>
</div>
</div>
<p>The above syntax is the vectorized version of the original code and works due to the <strong><em>broadcasting</em></strong>. Looking at the execution time for our big <code>array</code>, we see that it completes orders of magnitude faster than the <code>Python</code> loop:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1"></a><span class="op">%%</span>timeit </span>
<span id="cb135-2"><a href="#cb135-2"></a>(<span class="fl">1.0</span> <span class="op">/</span> big_array)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2.04 ms ± 19.1 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)</code></pre>
</div>
</div>
<p>The execution time is much faster since the vectorization operation is done via <code>ufuncs</code>, which is a compiled routine. Now we will introduce each concept in detail, including broadcasting, <code>ufuncs</code> and vectorization.</p>
<section id="element-wise-arithmetic" class="level4" data-number="9.5.1.1">
<h4 data-number="9.5.1.1" class="anchored" data-anchor-id="element-wise-arithmetic"><span class="header-section-number">9.5.1.1</span> Element-wise arithmetic</h4>
<p><code>NumPy</code> offers numerous operators that allow us to create simple expressions that carry out operations on whole arrays and returns another <code>array</code>. Firstly, let’s perform <strong>element-wise arithmetic with arrays and numeric values</strong> by employing arithmetic operators and augmented assignments. Element-wise operations are applied to each element, so the snippet below doubles every element and cubes every element. Each operation returns a new array containing the result:</p>
<div class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1"></a>numbers <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">7</span>) <span class="co"># array([1, 2, 3, 4, 5, 6])</span></span>
<span id="cb137-2"><a href="#cb137-2"></a>numbers <span class="op">*</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>array([ 2,  4,  6,  8, 10, 12])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1"></a>numbers <span class="op">**</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>array([  1,   8,  27,  64, 125, 216], dtype=int32)</code></pre>
</div>
</div>
<p>Augmented assignments modify every element in the left operand in place!</p>
<div class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1"></a>numbers <span class="op">+=</span> <span class="dv">10</span></span>
<span id="cb141-2"><a href="#cb141-2"></a>numbers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="90">
<pre><code>array([11, 12, 13, 14, 15, 16])</code></pre>
</div>
</div>
</section>
</section>
<section id="broadcasting" class="level3" data-number="9.5.2">
<h3 data-number="9.5.2" class="anchored" data-anchor-id="broadcasting"><span class="header-section-number">9.5.2</span> Broadcasting</h3>
<p>Typically, arithmetic operations necessitate two <code>arrays</code> of identical size and shape as operands. When one operand is a single value, known as a scalar, <code>NumPy</code> carries out the element-wise calculations <strong>as though the scalar were an array of the same shape as the other operand, but with the scalar value present in all its elements.</strong> This is referred to as <strong><em>broadcasting</em></strong>. The snippets above demonstrate this capability. For instance, <code>numbers * 2</code> is equivalent to <code>numbers * [2, 2, 2, 2, 2, 2]</code>.</p>
<p>Broadcasting can also be applied between <code>arrays</code> of varying sizes and shapes, enabling concise and powerful manipulations. We will present more examples of broadcasting later in this chapter when we introduce <code>NumPy</code>’s universal functions.</p>
<section id="arithmetic-operations-between-arrays" class="level4" data-number="9.5.2.1">
<h4 data-number="9.5.2.1" class="anchored" data-anchor-id="arithmetic-operations-between-arrays"><span class="header-section-number">9.5.2.1</span> Arithmetic Operations Between <code>arrays</code></h4>
<p>Arithmetic operations and augmented assignments can be performed between arrays of the same shape. Let’s multiply the one-dimensional arrays <code>numbers</code> and <code>numbers2</code> (created below), each containing five elements:</p>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1"></a>numbers2 <span class="op">=</span> np.linspace(<span class="fl">1.1</span>, <span class="fl">6.6</span>, <span class="dv">6</span>) </span>
<span id="cb143-2"><a href="#cb143-2"></a>numbers <span class="op">*</span> numbers2 <span class="co"># array([11, 12, 13, 14, 15, 16]) * array([ 1.1,  2.2,  3.3,  4.4,  5.5, 6.6])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">
<pre><code>array([ 12.1,  26.4,  42.9,  61.6,  82.5, 105.6])</code></pre>
</div>
</div>
<p>The outcome is a new <code>array</code> created by multiplying the elements of each operand element-wise — <code>11 * 1.1, 12 * 2.2, 13 * 3.3</code>, and so on. Arithmetic operations between <code>arrays</code> of integers and floating-point numbers result in an <code>array</code> of floating-point numbers. Let’s see another example:</p>
<div class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1"></a>c <span class="op">=</span> np.ones((<span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb145-2"><a href="#cb145-2"></a>c <span class="op">*</span> c </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="92">
<pre><code>array([[1., 1., 1.],
       [1., 1., 1.],
       [1., 1., 1.]])</code></pre>
</div>
</div>
<p>Note that the above operation is not matrix multiplication. To perform matrix multiplication use the <code>dot()</code> method!</p>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1"></a>c.dot(c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="93">
<pre><code>array([[3., 3., 3.],
       [3., 3., 3.],
       [3., 3., 3.]])</code></pre>
</div>
</div>
<p>The above operation is the same as using the <code>@</code> operator:</p>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1"></a>c <span class="op">@</span> c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">
<pre><code>array([[3., 3., 3.],
       [3., 3., 3.],
       [3., 3., 3.]])</code></pre>
</div>
</div>
<p>We can apply broadcasting to higher-dimensional <code>arrays</code> in a similar way. For instance, consider adding a one-dimensional <code>arra</code>y to a two-dimensional <code>array</code> and observe the resulting output:</p>
<div class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1"></a>a <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb151-2"><a href="#cb151-2"></a>M <span class="op">=</span> np.ones((<span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb151-3"><a href="#cb151-3"></a><span class="bu">print</span>(a.shape, M.shape)</span>
<span id="cb151-4"><a href="#cb151-4"></a>M <span class="op">+</span> a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(3,) (3, 3)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>array([[1., 2., 3.],
       [1., 2., 3.],
       [1., 2., 3.]])</code></pre>
</div>
</div>
<p>Here, the one-dimensional array <code>a</code> is stretched, or broadcasted, across the second dimension in order to match the shape of <code>M</code>.</p>
</section>
<section id="rules-of-broadcasting" class="level4" data-number="9.5.2.2">
<h4 data-number="9.5.2.2" class="anchored" data-anchor-id="rules-of-broadcasting"><span class="header-section-number">9.5.2.2</span> Rules of Broadcasting</h4>
<p>In <code>NumPy</code>, broadcasting adheres to a strict set of regulations that govern how two <code>arrays</code> interact with one another. These rules are as follows:</p>
<ol type="1">
<li>When the number of dimensions between two <code>arrays</code> differs, the <code>array</code> with fewer dimensions is padded with ones on its leading (left) side to match the number of dimensions of the other <code>array</code>.</li>
<li>If the shape of the two <code>arrays</code> doesn’t match in any dimension, the <code>array</code> with a shape of 1 in that dimension is expanded to match the shape of the other <code>array</code>.</li>
<li>If the sizes of the <code>arrays</code> conflict in any dimension and neither is equal to 1, an error is raised.</li>
</ol>
<p>Now let’s take a look at an example where both <code>arrays</code> need to be broadcast:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1"></a>a <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">40</span>, <span class="dv">10</span>).reshape(<span class="dv">4</span>,<span class="dv">1</span>)</span>
<span id="cb154-2"><a href="#cb154-2"></a>b <span class="op">=</span> np.arange(<span class="dv">3</span>)</span>
<span id="cb154-3"><a href="#cb154-3"></a><span class="bu">print</span>(a.shape, b.shape)</span>
<span id="cb154-4"><a href="#cb154-4"></a>a, b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(4, 1) (3,)</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>(array([[ 0],
        [10],
        [20],
        [30]]),
 array([0, 1, 2]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1"></a>a <span class="op">+</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[ 0,  1,  2],
       [10, 11, 12],
       [20, 21, 22],
       [30, 31, 32]])</code></pre>
</div>
</div>
<ol type="1">
<li><p>To begin, we need to determine the shapes of the two <code>arrays</code>: <code>a.shape</code> is <code>(4,1)</code> and <code>b.shape</code> is <code>(3,)</code>. According to Rule 1, we have to add ones to the shape of <code>b</code> such that its dimensions match those of <code>a</code>. Thus, <code>b.shape</code> becomes <code>(1,3)</code>.</p></li>
<li><p>Next, Rule 2 states that we need to expand each of the 1s in <code>b.shape</code> to match the corresponding size of the other <code>array</code>. Consequently, <code>a.shape</code> becomes <code>(4,3)</code>, and <code>b.shape</code> becomes <code>(4,3)</code> since 1 was replicated three times to match the size of <code>a</code>.</p></li>
<li><p>Since the shapes of the two <code>arrays</code> now match, they are compatible.</p></li>
</ol>
<p>This entire process can be depicted visually as follows:</p>
<center>
<img src="https://drive.google.com/uc?id=1zKGHApvzo2NvyuB2vLfu6en9WI0_QCUj" width="70%" height="70%">
</center>
<p>Next, let’s look at an example in which the two <code>arrays</code> are incompatible!</p>
<div class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1"></a>M <span class="op">=</span> np.ones((<span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb159-2"><a href="#cb159-2"></a>a <span class="op">=</span> np.arange(<span class="dv">3</span>)</span>
<span id="cb159-3"><a href="#cb159-3"></a></span>
<span id="cb159-4"><a href="#cb159-4"></a>M.shape, a.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="96">
<pre><code>((3, 2), (3,))</code></pre>
</div>
</div>
<ol type="1">
<li><p>First, we need to determine the shapes of the two <code>arrays</code>: <code>M.shape</code> is <code>(3,2)</code>, and <code>a.shape</code> is <code>(3,)</code>. As per Rule 1, we must pad ones to the shape of <code>a</code> such that its number of dimensions matches that of <code>M</code>. Consequently, <code>a.shape</code> becomes <code>(1, 3)</code>, while <code>M.shape</code> remains the same.</p></li>
<li><p>Next, Rule 2 requires that we stretch the first dimension of <code>a</code> to match that of <code>M</code>. Therefore, <code>a.shape</code> becomes <code>(3,3)</code>, while <code>M.shape</code> stays the same.</p></li>
<li><p>However, Rule 3 comes into play, here since the final shapes of the two <code>arrays</code> do not match. As a result, these two <code>arrays</code> are incompatible.</p></li>
</ol>
<p>This incompatibility is evident when we attempt to perform this operation.</p>
<div class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1"></a>M <span class="op">+</span> a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ValueError: operands could not be broadcast together with shapes (3,2) (3,) </code></pre>
</div>
</div>
</section>
<section id="comparing-arrays" class="level4" data-number="9.5.2.3">
<h4 data-number="9.5.2.3" class="anchored" data-anchor-id="comparing-arrays"><span class="header-section-number">9.5.2.3</span> Comparing arrays</h4>
<p>Both individual values and other arrays can be compared in <code>NumPy</code>. The comparisons are carried out element-wise, producing arrays of Boolean values where the value of each element represents the outcome of the comparison, either <code>True</code> or <code>False</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1"></a>numbers <span class="op">&gt;=</span> <span class="dv">13</span> <span class="co"># numbers = array([11, 12, 13, 14, 15, 16])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([False, False,  True,  True,  True,  True])</code></pre>
</div>
</div>
<p>Note that the above expression implicitly used broadcasting!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1"></a>numbers2 <span class="op">&lt;</span> numbers <span class="co"># numbers2 = array([ 1.1,  2.2,  3.3,  4.4,  5.5, 6.6])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([ True,  True,  True,  True,  True,  True])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1"></a>numbers <span class="op">==</span> numbers2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([False, False, False, False, False, False])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1"></a>numbers <span class="op">==</span> numbers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([ True,  True,  True,  True,  True,  True])</code></pre>
</div>
</div>
</section>
</section>
<section id="universal-functions-vectorization" class="level3" data-number="9.5.3">
<h3 data-number="9.5.3" class="anchored" data-anchor-id="universal-functions-vectorization"><span class="header-section-number">9.5.3</span> Universal Functions (Vectorization)</h3>
<p>Now we will delve into how <code>NumPy</code> perform element-wise operations on <code>arrays</code> without using the <code>for</code> loop: <code>NumPy</code> provides more operators/functions as standalone <strong><em>universal functions</em></strong> (also known as <code>ufuncs</code>) that perform various operations element-wise, meaning that they apply the same operation to each element in an <code>array</code>. These functions operate on one or two <code>array</code>-like arguments (such as <code>lists</code>) and are utilized to perform tasks. Some of these functions are automatically invoked when operators like <code>+</code> and <code>*</code> are used with <code>arrays</code>. Each <code>ufunc</code> generates a new <code>array</code> that contains the results of the operation.</p>
<p><code>NumPy</code> offers a practical interface for various kinds of operations that directly access statically typed and compiled routines. These operations are called <strong><em>vectorized operations</em></strong>. Vectorization is achieved using <code>array</code> operations, such as addition, subtraction, multiplication, and division. In addition, it can also be achieved by using <code>ufunc</code>. These vectorized methods are intended to move the loop to the compiled layer that underpins <code>NumPy</code>, leading to considerably quicker execution.</p>
<p>We can view the complete list, their descriptions and more information about universal functions at <a href="https://numpy.org/doc/stable/reference/ufuncs.html">https://numpy.org/doc/stable/reference/ufuncs.html</a></p>
<blockquote class="blockquote">
<p>See <a href="https://www.labri.fr/perso/nrougier/from-python-to-numpy/#problem-vectorization">here</a> for more vectorization examples in different thinking levels.</p>
</blockquote>
<section id="exploring-numpys-ufuncs" class="level4" data-number="9.5.3.1">
<h4 data-number="9.5.3.1" class="anchored" data-anchor-id="exploring-numpys-ufuncs"><span class="header-section-number">9.5.3.1</span> Exploring <code>NumPy</code>’s <code>Ufuncs</code></h4>
<p>Let’s add two <code>arrays</code> with the same shape, using the <code>add()</code> universal function:</p>
<div class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1"></a>numbers2 <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">7</span>) <span class="op">*</span> <span class="dv">10</span>  <span class="co"># array([10, 20, 30, 40, 50, 60])</span></span>
<span id="cb171-2"><a href="#cb171-2"></a>np.add(numbers, numbers2)        <span class="co"># equivalent to numbers + numbers2, numbers = array([11, 12, 13, 14, 15, 16])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="103">
<pre><code>array([21, 32, 43, 54, 65, 76])</code></pre>
</div>
</div>
</section>
<section id="broadcasting-with-universal-functions" class="level4" data-number="9.5.3.2">
<h4 data-number="9.5.3.2" class="anchored" data-anchor-id="broadcasting-with-universal-functions"><span class="header-section-number">9.5.3.2</span> Broadcasting with Universal Functions</h4>
<p>Let’s use the <code>multiply()</code> universal function to multiply every element of <code>numbers2</code> by the scalar value 5:</p>
<div class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1"></a>np.multiply(numbers2, <span class="dv">5</span>) <span class="co"># equivalent to numbers2 * 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">
<pre><code>array([ 50, 100, 150, 200, 250, 300])</code></pre>
</div>
</div>
<p>Let’s reshape <code>numbers2</code> into a 2-by-3 array, then multiply its values by a one-dimensional <code>array</code> of three elements:</p>
<div class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1"></a>numbers3 <span class="op">=</span> numbers2.reshape(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb175-2"><a href="#cb175-2"></a>numbers4 <span class="op">=</span> np.array([<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>])</span>
<span id="cb175-3"><a href="#cb175-3"></a>numbers3, numbers4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="105">
<pre><code>(array([[10, 20, 30],
        [40, 50, 60]]),
 array([2, 4, 6]))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1"></a>np.multiply(numbers3, numbers4) <span class="co"># Equivalent to numbers3 * numbers4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="106">
<pre><code>array([[ 20,  80, 180],
       [ 80, 200, 360]])</code></pre>
</div>
</div>
<p>In this case, <code>numbers4</code> has the same length as each row of <code>numbers3</code>, allowing <code>NumPy</code> to apply the multiplication operation by treating <code>numbers4</code> as an <code>array</code> with the following values:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1"></a>array([[<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>],</span>
<span id="cb179-2"><a href="#cb179-2"></a>       [<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If a universal function receives two <code>arrays</code> with different shapes that do not support broadcasting, a <code>ValueError</code> is raised. Vectorization and <code>ufunc</code> functions are closely associated with broadcasting in <code>NumPy</code>, as they are frequently employed together to perform element-wise operations on arrays with varying shapes. By combining vectorization, <code>ufunc</code> functions, and broadcasting, we can effectively execute complex arithmetic operations on <code>NumPy</code> <code>arrays</code>.</p>
<p>There are other special mathematical <code>ufunc</code>. Let’s create an array and calculate the square root of its values using the <code>sin()</code> universal function:</p>
<div class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1"></a>numbers <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">16</span>, <span class="dv">25</span>, <span class="dv">36</span>])</span>
<span id="cb180-2"><a href="#cb180-2"></a>np.sin(numbers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="107">
<pre><code>array([ 0.84147098, -0.7568025 ,  0.41211849, -0.28790332, -0.13235175,
       -0.99177885])</code></pre>
</div>
</div>
</section>
<section id="create-our-own-vectorizing-functions" class="level4" data-number="9.5.3.3">
<h4 data-number="9.5.3.3" class="anchored"><span class="header-section-number">9.5.3.3</span> Create our own vectorizing functions</h4>
<p>The vectorized operation are often more concise, and it is thus advisable to avoid element-wise looping over vectors and matrices and instead employ vectorized algorithms. The initial step in converting a scalar algorithm to a vectorized algorithm involves verifying that the functions we create can function with vector inputs:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1"></a><span class="kw">def</span> Theta(x, th):</span>
<span id="cb182-2"><a href="#cb182-2"></a>    <span class="co">"""</span></span>
<span id="cb182-3"><a href="#cb182-3"></a><span class="co">    Scalar implemenation of a variant of Heaviside step function.</span></span>
<span id="cb182-4"><a href="#cb182-4"></a><span class="co">    """</span></span>
<span id="cb182-5"><a href="#cb182-5"></a>    <span class="cf">if</span> x <span class="op">&gt;=</span> th:</span>
<span id="cb182-6"><a href="#cb182-6"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb182-7"><a href="#cb182-7"></a>    <span class="cf">else</span>:</span>
<span id="cb182-8"><a href="#cb182-8"></a>        <span class="cf">return</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can achieve this using <code>np.vectorize</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1"></a>Theta_vec <span class="op">=</span> np.vectorize(Theta)</span>
<span id="cb183-2"><a href="#cb183-2"></a>Theta_vec(np.array([<span class="op">-</span><span class="dv">3</span>,<span class="op">-</span><span class="dv">2</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]), <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([0, 0, 0, 0, 1, 1, 1])</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Don’t assume <code>np.vectorize()</code> is faster. It is mainly for convenient and concise purposes as described <a href="https://numpy.org/doc/stable/reference/generated/numpy.vectorize.html">here</a>.</p>
</blockquote>
<blockquote class="blockquote">
<h3 id="exercise-2-suppose-we-are-dealing-with-a-spreadsheet-that-records-the-grade-of-students.-the-grade-contains-the-homework-midterm-and-finals-as-follows" data-number="9.5.4" class="anchored" data-anchor-id="create-our-own-vectorizing-functions"><span class="header-section-number">9.5.4</span> Exercise 2: Suppose we are dealing with a spreadsheet that records the grade of students. The grade contains the homework, midterm and finals as follows:</h3>
</blockquote>
<div data-align="center">
<table class="table">
<thead>
<tr class="header">
<th>Name</th>
<th>HW1</th>
<th>HW2</th>
<th>HW3</th>
<th>HW4</th>
<th>Midterm</th>
<th>Final</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Alice</td>
<td>90</td>
<td>80</td>
<td>70</td>
<td>100</td>
<td>90</td>
<td>95</td>
</tr>
<tr class="even">
<td>Bob</td>
<td>80</td>
<td>90</td>
<td>100</td>
<td>70</td>
<td>85</td>
<td>80</td>
</tr>
<tr class="odd">
<td>Charlie</td>
<td>70</td>
<td>100</td>
<td>90</td>
<td>80</td>
<td>95</td>
<td>90</td>
</tr>
<tr class="even">
<td>David</td>
<td>60</td>
<td>70</td>
<td>80</td>
<td>90</td>
<td>85</td>
<td>100</td>
</tr>
<tr class="odd">
<td>Eve</td>
<td>50</td>
<td>60</td>
<td>70</td>
<td>80</td>
<td>75</td>
<td>90</td>
</tr>
</tbody>
</table>
</div>
<p>We would like to calculate the semester score of each student by the following rules:</p>
<ol type="1">
<li><p>The weight of each score is 0.2 (the summation of four homework accounts for 20% of the total scores and each homework has the same weight), 0.4 and 0.4 for HW, Midterm and Final, respectively.</p></li>
<li><p>We adjust each student’s score so that the top performer in the class gets a score of 100 by adding the same constant score to each student’s score.</p></li>
</ol>
<p>We use a 2D array to model the grades so that each row corresponds to a student’s score. Use the following template to complete the task:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1"></a>grades <span class="op">=</span> np.array([[<span class="dv">90</span>, <span class="dv">80</span>, <span class="dv">70</span>, <span class="dv">100</span>, <span class="dv">90</span>, <span class="dv">95</span>],</span>
<span id="cb185-2"><a href="#cb185-2"></a>                   [<span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">100</span>, <span class="dv">70</span>, <span class="dv">85</span>, <span class="dv">80</span>],</span>
<span id="cb185-3"><a href="#cb185-3"></a>                   [<span class="dv">70</span>, <span class="dv">100</span>, <span class="dv">90</span>, <span class="dv">80</span>, <span class="dv">95</span>, <span class="dv">90</span>],</span>
<span id="cb185-4"><a href="#cb185-4"></a>                   [<span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">85</span>, <span class="dv">100</span>],</span>
<span id="cb185-5"><a href="#cb185-5"></a>                   [<span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">75</span>, <span class="dv">90</span>]])</span>
<span id="cb185-6"><a href="#cb185-6"></a></span>
<span id="cb185-7"><a href="#cb185-7"></a>weights <span class="op">=</span> np.array([])</span>
<span id="cb185-8"><a href="#cb185-8"></a>scores</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1"></a><span class="co"># Your code here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="type-casting" class="level3" data-number="9.5.5">
<h3 data-number="9.5.5" class="anchored" data-anchor-id="type-casting"><span class="header-section-number">9.5.5</span> Type casting</h3>
<p>Due to the nature of static typing, the type of a <code>NumPy</code> <code>array</code> does not change once created. However, we can explicitly convert an <code>array</code> of one type to another using the <code>astype()</code> function. This operation always generates a new <code>array</code> with a new type.</p>
<div class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1"></a>M <span class="op">=</span> np.random.rand(<span class="dv">5</span>,<span class="dv">5</span>)</span>
<span id="cb187-2"><a href="#cb187-2"></a>M.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="112">
<pre><code>dtype('float64')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1"></a>M2 <span class="op">=</span> M.astype(np.int64)</span>
<span id="cb189-2"><a href="#cb189-2"></a>M2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="113">
<pre><code>array([[0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0]], dtype=int64)</code></pre>
</div>
</div>
<p>See <a href="https://scipy-lectures.org/intro/numpy/elaborate_arrays.html">https://scipy-lectures.org/intro/numpy/elaborate_arrays.html</a> for more details.</p>
</section>
</section>
<section id="file-io" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="file-io"><span class="header-section-number">9.6</span> File I/O</h2>
<p><code>NumPy</code> has its own binary format, not portable but with efficient I/O. This is useful when storing and reading back <code>array</code> data. Use the functions <code>numpy.save()</code> and <code>numpy.load()</code>.</p>
<div class="cell" data-execution_count="114">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1"></a>np.save(<span class="st">"random-matrix.npy"</span>, M)</span>
<span id="cb191-2"><a href="#cb191-2"></a>M2 <span class="op">=</span> np.load(<span class="st">"random-matrix.npy"</span>)</span>
<span id="cb191-3"><a href="#cb191-3"></a>M2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="114">
<pre><code>array([[0.38791019, 0.93061564, 0.33040029, 0.9810319 , 0.92882123],
       [0.87579212, 0.57436978, 0.99856211, 0.83380903, 0.34188505],
       [0.30067505, 0.99334148, 0.89929337, 0.78057549, 0.10613898],
       [0.71493999, 0.02124826, 0.95090779, 0.12435095, 0.55611604],
       [0.05511708, 0.7047183 , 0.26478257, 0.21195283, 0.77090752]])</code></pre>
</div>
</div>
<p>In summary:</p>
<p>To make the code faster using <code>NumPy</code></p>
<ul>
<li>In place operations: <code>a *= 3</code> instead of <code>a = 3*a</code></li>
<li>Use views instead of copies whenever possible</li>
<li>Broadcasting: Use broadcasting to do operations on <code>arrays</code></li>
<li>Vectorizing <code>for</code> loops: Find tricks to avoid <code>for</code> loops using <code>NumPy</code> <code>arrays</code>.</li>
</ul>
<p>The comparisons between <code>list</code> and <code>array</code> are summarized as follows:</p>
<p><strong>Python</strong> objects:</p>
<ul>
<li><code>Python</code> <code>lists</code> are very general. They can contain any kind of object and are dynamically typed</li>
<li>However, they do not support mathematical functions such as matrix multiplications. Implementing such functions for <code>Python</code> <code>lists</code> would not be very efficient because of the dynamic typing</li>
</ul>
<p><strong>NumPy</strong> provides:</p>
<ul>
<li><code>Numpy</code> <code>arrays</code> are <strong>statically typed</strong> and <strong>homogeneous</strong>. The type of the elements is determined when the <code>array</code> is created</li>
<li>Because of the static typing, fast implementation of mathematical functions such as multiplication and addition of <code>NumPy</code> arrays can be implemented in a compiled language (C and Fortran is used). Moreover, <code>Numpy</code> <code>arrays</code> are memory efficient</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./08_09_OOP.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Object Oriented Programming and Classes</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./12_Matplotlib.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Visualization with <code>Matplotlib</code></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>