<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.306">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="phonchi">
<meta name="dcterms.date" content="2023-05-05">

<title>Computer Programming - Appendix B — High-level scientific computing with SciPy</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04_Algorithms_sol.html" rel="next">
<link href="./00_Copilot.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./00_Copilot.html">Appendices</a></li><li class="breadcrumb-item"><a href="./00_SciPy.html"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">High-level scientific computing with `SciPy`</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Computer Programming</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Python Basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Flow_control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Flow Control</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Lists_tuples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Lists and Tuples</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Dictionaries_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Other collections - Dictionaries and Sets</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Manipulating_string.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Manipulating Strings</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_Files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Files and Exceptions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_09_OOP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Object Oriented Programming and Classes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_11_NumPy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Array-Oriented Programming with NumPy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_Matplotlib.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Visualization with <code>Matplotlib</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_SymPy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Symbolic Mathematics in Python with <code>SymPy</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_Copilot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Increase productivity and learning with Github Copilot in Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_SciPy.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">High-level scientific computing with <code>SciPy</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Algorithms_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Algorithms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Data_Structure_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Data Structure</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Abstract_data_types_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Abstract Data Types</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 1_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Assignment 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 2_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Assignment 2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 3_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Assignment 3</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 4_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Assignment 4</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 5_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Assignment 5</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 6_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Assignment 6</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 7_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Assignment 7</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 8_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">M</span>&nbsp; <span class="chapter-title">Assignment 8</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 9_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">N</span>&nbsp; <span class="chapter-title">Assignment 9</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Quiz1_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">O</span>&nbsp; <span class="chapter-title">Quiz 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Quiz2_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">P</span>&nbsp; <span class="chapter-title">Quiz 2</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">B.1</span> Introduction</a></li>
  <li><a href="#linear-algebra-with-scipy" id="toc-linear-algebra-with-scipy" class="nav-link" data-scroll-target="#linear-algebra-with-scipy"><span class="header-section-number">B.2</span> Linear algebra with <code>SciPy</code></a>
  <ul class="collapse">
  <li><a href="#using-scipy.linalg.solve-to-solve-linear-systems" id="toc-using-scipy.linalg.solve-to-solve-linear-systems" class="nav-link" data-scroll-target="#using-scipy.linalg.solve-to-solve-linear-systems"><span class="header-section-number">B.2.1</span> Using <code>scipy.linalg.solve()</code> to solve linear systems</a></li>
  <li><a href="#exploring-eigenvalues-and-eigenvectors-using-scipy.linalg.eig" id="toc-exploring-eigenvalues-and-eigenvectors-using-scipy.linalg.eig" class="nav-link" data-scroll-target="#exploring-eigenvalues-and-eigenvectors-using-scipy.linalg.eig"><span class="header-section-number">B.2.2</span> Exploring eigenvalues and eigenvectors using <code>scipy.linalg.eig()</code></a></li>
  </ul></li>
  <li><a href="#numerical-integration-with-scipy" id="toc-numerical-integration-with-scipy" class="nav-link" data-scroll-target="#numerical-integration-with-scipy"><span class="header-section-number">B.3</span> Numerical Integration with <code>SciPy</code></a>
  <ul class="collapse">
  <li><a href="#definite-integral" id="toc-definite-integral" class="nav-link" data-scroll-target="#definite-integral"><span class="header-section-number">B.3.1</span> Definite integral</a></li>
  </ul></li>
  <li><a href="#optimization" id="toc-optimization" class="nav-link" data-scroll-target="#optimization"><span class="header-section-number">B.4</span> Optimization</a>
  <ul class="collapse">
  <li><a href="#curve-fitting" id="toc-curve-fitting" class="nav-link" data-scroll-target="#curve-fitting"><span class="header-section-number">B.4.1</span> Curve fitting</a></li>
  <li><a href="#finding-the-minimum-of-a-scalar-function" id="toc-finding-the-minimum-of-a-scalar-function" class="nav-link" data-scroll-target="#finding-the-minimum-of-a-scalar-function"><span class="header-section-number">B.4.2</span> Finding the minimum of a scalar function</a></li>
  <li><a href="#finding-the-roots-of-a-scalar-function" id="toc-finding-the-roots-of-a-scalar-function" class="nav-link" data-scroll-target="#finding-the-roots-of-a-scalar-function"><span class="header-section-number">B.4.3</span> Finding the roots of a scalar function</a></li>
  </ul></li>
  <li><a href="#statistics" id="toc-statistics" class="nav-link" data-scroll-target="#statistics"><span class="header-section-number">B.5</span> Statistics</a>
  <ul class="collapse">
  <li><a href="#distributions-histogram-and-probability-density-function" id="toc-distributions-histogram-and-probability-density-function" class="nav-link" data-scroll-target="#distributions-histogram-and-probability-density-function"><span class="header-section-number">B.5.1</span> Distributions: histogram and probability density function</a></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing"><span class="header-section-number">B.5.2</span> Hypothesis testing</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Appendix B — High-level scientific computing with <code>SciPy</code></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>phonchi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 5, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introduction" class="level2" data-number="B.1">
<h2 data-number="B.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">B.1</span> Introduction</h2>
<p>Serving as the central package for scientific operations in <code>Python</code>, <code>SciPy</code> is specifically designed to work efficiently with <code>NumPy</code> arrays. Before we develop a new routine, it’s advisable to verify if <code>SciPy</code> already offers the required data processing functionality. As non-professional programmers, scientists may sometimes duplicate existing solutions, leading to error-prone, suboptimal, hard-to-share, and unmaintainable code. In contrast, <code>SciPy</code> provides optimized and tested routines, which we should utilize whenever feasible.</p>
<p><code>SciPy</code> is composed of task-specific sub-modules:</p>
<div data-align="center">
<table class="table">
<thead>
<tr class="header">
<th>Module</th>
<th>Functionality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>scipy.integrate</td>
<td>Integration routines</td>
</tr>
<tr class="even">
<td>scipy.linalg</td>
<td>Linear algebra routines</td>
</tr>
<tr class="odd">
<td>scipy.optimize</td>
<td>Optimization</td>
</tr>
<tr class="even">
<td>scipy.stats</td>
<td>Statistics</td>
</tr>
</tbody>
</table>
</div>
<p>They all depend on <code>NumPy</code>, but are mostly independent of each other. The standard way of importing these modules is:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683195693581,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="670ab3a6-89de-476c-9845-921f4913eece" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a>package_name <span class="op">=</span> <span class="st">"scipy"</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="cf">try</span>:</span>
<span id="cb1-4"><a href="#cb1-4"></a>    <span class="bu">__import__</span>(package_name)</span>
<span id="cb1-5"><a href="#cb1-5"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>package_name<span class="sc">}</span><span class="ss"> is already installed."</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="cf">except</span> <span class="pp">ImportError</span>:</span>
<span id="cb1-7"><a href="#cb1-7"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>package_name<span class="sc">}</span><span class="ss"> not found. Installing..."</span>)</span>
<span id="cb1-8"><a href="#cb1-8"></a>    <span class="op">%</span>pip install {package_name}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>scipy is already installed.</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:804,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683195694382,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="im">from</span> scipy <span class="im">import</span> linalg    <span class="co"># same for other sub-modules</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="im">from</span> scipy <span class="im">import</span> integrate <span class="co"># same for other sub-modules</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="im">from</span> scipy <span class="im">import</span> optimize  <span class="co"># same for other sub-modules</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="im">from</span> scipy <span class="im">import</span> stats     <span class="co"># same for other sub-modules</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The primary <code>SciPy</code> namespace predominantly includes functions that actually belong to <code>NumPy</code>. These functions are exposed for historical reasons, and there’s no need to use <code>import scipy</code> in our code.</p>
</section>
<section id="linear-algebra-with-scipy" class="level2" data-number="B.2">
<h2 data-number="B.2" class="anchored" data-anchor-id="linear-algebra-with-scipy"><span class="header-section-number">B.2</span> Linear algebra with <code>SciPy</code></h2>
<p><code>NumPy</code> provides some tools for handling linear algebra applications within the <code>numpy.linalg</code> module. However, it is typically more advantageous to use <code>scipy.linalg</code> instead, unless you want to avoid adding <code>SciPy</code> as a dependency to your project. There are a few reasons for this preference:</p>
<ul>
<li><p>As the <a href="https://docs.scipy.org/doc/scipy/tutorial/linalg.html#scipy-linalg-vs-numpy-linalg">official documentation</a> points out, <code>scipy.linalg</code> encompasses all the functions found in <code>numpy.linalg</code>, along with additional advanced functions not present in <code>numpy.linalg</code>.</p></li>
<li><p><code>scipy.linalg</code> always includes support for BLAS and LAPACK, which are libraries containing routines for executing numerical operations in an optimized manner. Conversely, the use of BLAS and LAPACK in <code>numpy.linalg</code> is optional. As a result, depending on your <code>NumPy</code> installation, <code>scipy.linalg</code> functions could be faster than those in <code>numpy.linalg</code>.</p></li>
</ul>
<p>In summary, given that scientific and technical applications usually don’t impose limitations on dependencies, opting for <code>scipy.linalg</code> over <code>numpy.linalg</code> is generally a wise decision.</p>
<section id="using-scipy.linalg.solve-to-solve-linear-systems" class="level3" data-number="B.2.1">
<h3 data-number="B.2.1" class="anchored" data-anchor-id="using-scipy.linalg.solve-to-solve-linear-systems"><span class="header-section-number">B.2.1</span> Using <code>scipy.linalg.solve()</code> to solve linear systems</h3>
<p>Linear systems can be valuable tools in finding solutions to various practical and significant problems. A linear system of equations consists of a set of linear equations:</p>
<p><span class="math display">\[\begin{align}
a_{0,0}x_0 + a_{0,1}x_1 + \cdots + a_{0,n}x_n &amp; = b_0 \\\
a_{1,0}x_0 + a_{1,1}x_1 + \cdots + a_{1,n}x_n &amp; = b_1 \\\
&amp; \vdots \\\
a_{m,0}x_0 + a_{m,1}x_1 + \cdots + a_{m,n}x_n &amp; = b_m \\\
\end{align}\]</span>a_{1,0}x_0 + a_{1,1}x_1 + + a_{1,n}x_n &amp; = b_1 \<br>
&amp; \<br>
a_{m,0}x_0 + a_{m,1}x_1 + + a_{m,n}x_n &amp; = b_m \<br>
\end{align}</p>
<p>Using matrix notation, a linear system can be represented as <span class="math inline">\(A \mathbf{x}= \mathbf{b}\)</span>, where</p>
<p><span class="math display">\[
A = \begin{bmatrix}
a_{0,0} &amp; a_{0,1} &amp; \cdots &amp; a_{0,n} \\\
a_{1,0} &amp; a_{1,1} &amp; \cdots &amp; a_{1,n} \\\
\vdots &amp; &amp; &amp; \vdots \\\
a_{m,0} &amp; a_{m,1} &amp; \cdots &amp; a_{m,n} \\\
\end{bmatrix}
\ \ , \ \
\mathbf{x} = \begin{bmatrix}
x_0 \\\ x_1 \\\ \vdots \\\ x_n
\end{bmatrix}
\ \ , \ \
\mathbf{b} = \begin{bmatrix}
b_0 \\\ b_1 \\\ \vdots \\\ b_m
\end{bmatrix}
\]</span></p>
<p>In this section, you will explore how to leverage <code>scipy.linalg.solve()</code> for solving linear systems. To illustrate its application, consider the example system below:</p>
<p><span class="math display">\[
\begin{align}
3x + 2y &amp;= 12 \\
2x - y &amp;= 1
\end{align}
\]</span></p>
<p>To take advantage of <code>scipy.linalg.solve()</code>, you must first represent the linear system as a matrix product, as demonstrated in the following equation:</p>
<p><span class="math display">\[
\begin{bmatrix}
3 &amp; 2 \\
2 &amp; -1
\end{bmatrix}
\times
\begin{bmatrix}
x \\
y
\end{bmatrix}
=
\begin{bmatrix}
12 \\
1
\end{bmatrix}
\]</span></p>
<p>Once this is done, you can utilize <code>scipy.linalg.solve()</code> to determine the solution to the system:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:283,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683171867659,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="16877afb-51bd-4710-909b-096d4e040438">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>A <span class="op">=</span> np.array([</span>
<span id="cb4-2"><a href="#cb4-2"></a>    [<span class="dv">3</span>, <span class="dv">2</span>],</span>
<span id="cb4-3"><a href="#cb4-3"></a>    [<span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb4-4"><a href="#cb4-4"></a>])</span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co"># To make it a column vector with two lines</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>b <span class="op">=</span> np.array([<span class="dv">12</span>, <span class="dv">1</span>]).reshape((<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a>x <span class="op">=</span> linalg.solve(A, b)</span>
<span id="cb4-10"><a href="#cb4-10"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>array([[2.],
       [3.]])</code></pre>
</div>
</div>
<p>We can verify that the solution is correct by:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:267,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683171873801,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="76167259-88ea-47df-f509-97d8756b38c6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>A <span class="op">@</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>array([[12.],
       [ 1.]])</code></pre>
</div>
</div>
<p>Alternatively, matrix inversion can also be employed to solve the system. We can compute the inverse of matrix <span class="math inline">\(A\)</span> using <code>scipy.linalg.inv()</code> and then multiply it with vector <span class="math inline">\(b\)</span>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:281,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683171896767,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="1bb3dc87-e736-49df-fde5-a669b0b03b72">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>A_inv <span class="op">=</span> linalg.inv(A)</span>
<span id="cb8-2"><a href="#cb8-2"></a>x <span class="op">=</span> A_inv <span class="op">@</span> b</span>
<span id="cb8-3"><a href="#cb8-3"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>array([[2.],
       [3.]])</code></pre>
</div>
</div>
<p>Since this system possesses a unique solution, the determinant of matrix <span class="math inline">\(A\)</span> must be non-zero. You can verify this by calculating the determinant using <code>det()</code> from <code>scipy.linalg</code>:</p>
<div class="cell" data-outputid="8778de54-b0c8-4bd3-c579-25e7e5f89a6e">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>linalg.det(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>-6.999999999999999</code></pre>
</div>
</div>
<p>As anticipated, the determinant is not zero. This confirms that the inverse of <span class="math inline">\(A\)</span>, denoted as <span class="math inline">\(A^{-1}\)</span> and computed using <code>inv(A)</code>, does exist, implying that the system possesses a unique solution.</p>
<section id="solve-or-matrix-inverse" class="level4" data-number="B.2.1.1">
<h4 data-number="B.2.1.1" class="anchored" data-anchor-id="solve-or-matrix-inverse"><span class="header-section-number">B.2.1.1</span> Solve or matrix inverse?</h4>
<p>Utilizing the inverse <span class="math inline">\(A^{-1}\)</span> to solve <span class="math inline">\(A \mathbf{x} = \mathbf{b}\)</span> is not recommended for large matrices, as it can be computationally expensive. To demonstrate, let’s create a large random matrix <span class="math inline">\(A\)</span> and vector <span class="math inline">\(\mathbf{b}\)</span>, and then compute the solution <span class="math inline">\(\mathbf{x}\)</span> using two different methods:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>N <span class="op">=</span> <span class="dv">10_000</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>A <span class="op">=</span> np.random.rand(N,N)</span>
<span id="cb12-3"><a href="#cb12-3"></a>b <span class="op">=</span> np.random.rand(N,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we compare the speed of <code>scipy.linalg.solve()</code> with <code>scipy.linalg.inv()</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:144669,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683172276135,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="db522361-84d0-47e7-a539-e5008e8b6119">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="op">%%</span>timeit</span>
<span id="cb13-2"><a href="#cb13-2"></a>x <span class="op">=</span> linalg.solve(A,b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>18 s ± 849 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:441599,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683172717732,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="02639ae3-8af0-403e-e6a1-511fb28237ed">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="op">%%</span>timeit</span>
<span id="cb15-2"><a href="#cb15-2"></a>x <span class="op">=</span> linalg.inv(A) <span class="op">@</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>55.3 s ± 1.86 s per loop (mean ± std. dev. of 7 runs, 1 loop each)</code></pre>
</div>
</div>
<p>Solving with <code>scipy.linalg.solve()</code> is faster!</p>
</section>
</section>
<section id="exploring-eigenvalues-and-eigenvectors-using-scipy.linalg.eig" class="level3" data-number="B.2.2">
<h3 data-number="B.2.2" class="anchored" data-anchor-id="exploring-eigenvalues-and-eigenvectors-using-scipy.linalg.eig"><span class="header-section-number">B.2.2</span> Exploring eigenvalues and eigenvectors using <code>scipy.linalg.eig()</code></h3>
<p>Let <span class="math inline">\(A\)</span> be a square matrix. A non-zero vector <span class="math inline">\(\mathbf{v}\)</span> is considered an eigenvector for <span class="math inline">\(A\)</span> with eigenvalue <span class="math inline">\(\lambda\)</span> if</p>
<p><span class="math display">\[
A\mathbf{v} = \lambda \mathbf{v}
\]</span></p>
<p>By rearranging the equation, it becomes apparent that <span class="math inline">\(\mathbf{v}\)</span> is a solution to the homogeneous system of equations</p>
<p><span class="math display">\[
\left( A - \lambda I \right) \mathbf{v} = \mathbf{0}
\]</span></p>
<p>Here, <span class="math inline">\(I\)</span> represents the identity matrix of size <span class="math inline">\(n\)</span>. Non-trivial solutions can only exist if the matrix <span class="math inline">\(A - \lambda I\)</span> is singular, which implies <span class="math inline">\(\mathrm{det}(A - \lambda I) = 0\)</span>. Consequently, the eigenvalues of <span class="math inline">\(A\)</span> are the roots of the characteristic polynomial</p>
<p><span class="math display">\[
p(\lambda) = \mathrm{det}(A - \lambda I)
\]</span></p>
<p>The <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.eig.html"><code>scipy.linalg.eig()</code></a> function calculates the eigenvalues and eigenvectors of a square matrix <span class="math inline">\(A\)</span>. Let’s examine a basic example featuring a diagonal matrix:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:29,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683172717733,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="d96d3c61-7177-4285-f534-dcc0be2301d9">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="dv">0</span>],[<span class="dv">0</span>,<span class="op">-</span><span class="dv">2</span>]])</span>
<span id="cb17-2"><a href="#cb17-2"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>array([[ 1,  0],
       [ 0, -2]])</code></pre>
</div>
</div>
<p>The <code>linalg.eig()</code> function returns a <code>tuple</code> <code>(eigvals, eigvecs)</code>, where <code>eigvals</code> is a 1D <code>NumPy</code> array containing complex numbers representing the eigenvalues of <span class="math inline">\(A\)</span>, and <code>eigvecs</code> is a 2D NumPy array with the corresponding eigenvectors arranged in the columns:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:26,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683172717733,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="4cb9a254-01a2-4625-e019-a49c708ee0c9">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>eigvals, eigvecs <span class="op">=</span> linalg.eig(A)</span>
<span id="cb19-2"><a href="#cb19-2"></a>eigvals, eigvecs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>(array([ 1.+0.j, -2.+0.j]),
 array([[1., 0.],
        [0., 1.]]))</code></pre>
</div>
</div>
<p>If we are certain that the eigenvalues are real numbers (i.e., if <span class="math inline">\(A\)</span> is symmetric), we can apply the <code>NumPy</code> array method <code>real()</code> to convert the array of eigenvalues into real numbers:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:23,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683172717734,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="28f643fb-9013-4ceb-ae40-ceca707e9901">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a>eigvals <span class="op">=</span> eigvals.real</span>
<span id="cb21-2"><a href="#cb21-2"></a>eigvals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>array([ 1., -2.])</code></pre>
</div>
</div>
<p>Notice that the position of an eigenvalue in the <code>eigvals</code> array corresponds to the column in <code>eigvecs</code> containing its associated eigenvector:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:19,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683172717734,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="3c13e6d4-f7c0-4a8a-f458-cd057315bb9c">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a>lambda1 <span class="op">=</span> eigvals[<span class="dv">1</span>]</span>
<span id="cb23-2"><a href="#cb23-2"></a>v1 <span class="op">=</span> eigvecs[:,<span class="dv">1</span>].reshape(<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb23-3"><a href="#cb23-3"></a>lambda1, v1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>(-2.0,
 array([[0.],
        [1.]]))</code></pre>
</div>
</div>
<p>We can verify that the solution is correct:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:16,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683172717735,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="67fed03b-d479-413a-d9bb-aa27b5e9b6b5">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a>A <span class="op">@</span> v1 <span class="op">==</span> lambda1 <span class="op">*</span> v1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>(array([[ 0.],
        [-2.]]),
 array([[-0.],
        [-2.]]))</code></pre>
</div>
</div>
<section id="symmetric-matrices" class="level4" data-number="B.2.2.1">
<h4 data-number="B.2.2.1" class="anchored" data-anchor-id="symmetric-matrices"><span class="header-section-number">B.2.2.1</span> Symmetric Matrices</h4>
<p>Indeed, for a symmetric matrix, the eigenvalues are always real and the eigenvectors are always orthogonal. Let’s confirm these properties using some random matrices:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:12,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683172717735,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="12b3b02b-fbee-4f2b-aa2f-600277867332">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>n <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>P <span class="op">=</span> np.random.randint(<span class="dv">0</span>,<span class="dv">10</span>,(n,n))</span>
<span id="cb27-3"><a href="#cb27-3"></a>P</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>array([[7, 7, 8, 4],
       [8, 2, 1, 2],
       [4, 9, 7, 2],
       [3, 7, 8, 4]])</code></pre>
</div>
</div>
<p>We can create symmetric matrix using <span class="math inline">\(S = P P^T\)</span>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:299,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683172763764,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="dcc5c485-e7dd-4efc-e012-8c6ccf355afc">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a>S <span class="op">=</span> P <span class="op">@</span> P.T</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="bu">print</span>(S)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[178  86 155 150]
 [ 86  73  61  54]
 [155  61 150 139]
 [150  54 139 138]]</code></pre>
</div>
</div>
<p>Let’s unpack the eigenvalues and eigenvectors of <span class="math inline">\(S\)</span>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683172764835,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="7d792967-8db2-4a00-a8f0-9d0cadaafd51">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a>evals, evecs <span class="op">=</span> linalg.eig(S)</span>
<span id="cb31-2"><a href="#cb31-2"></a>evals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>array([4.85858726e+02+0.j, 4.71560580e+01+0.j, 2.82127092e-01+0.j,
       5.70308921e+00+0.j])</code></pre>
</div>
</div>
<p>As observed, the eigenvalues have zero imaginary parts, confirming that they are indeed real numbers. Now, let’s verify that the eigenvectors are orthogonal to one another:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683172766362,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="65a033ca-fd9f-4f86-d397-b3d00878f49f">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a>v1 <span class="op">=</span> evecs[:,<span class="dv">0</span>] <span class="co"># First column is the first eigenvector</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>v2 <span class="op">=</span> evecs[:,<span class="dv">1</span>] <span class="co"># Second column is the second eigenvector</span></span>
<span id="cb33-3"><a href="#cb33-3"></a></span>
<span id="cb33-4"><a href="#cb33-4"></a>v1 <span class="op">@</span> v2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>8.326672684688674e-17</code></pre>
</div>
</div>
<p>The dot product of eigenvectors <span class="math inline">\(\mathbf{v}_1\)</span> and <span class="math inline">\(\mathbf{v}_2\)</span> is zero (the number shown is <em>very</em> close to zero, attributable to rounding errors in the computations), which confirms their orthogonality!</p>
</section>
<section id="diagonalization" class="level4" data-number="B.2.2.2">
<h4 data-number="B.2.2.2" class="anchored" data-anchor-id="diagonalization"><span class="header-section-number">B.2.2.2</span> Diagonalization</h4>
<p>A square matrix <span class="math inline">\(M\)</span> is diagonalizable if there exists an invertible matrix <span class="math inline">\(P\)</span> such that <span class="math inline">\(D = P^{-1}MP\)</span> is a diagonal matrix. A remarkable result in linear algebra states that a square matrix <span class="math inline">\(M\)</span> of size <span class="math inline">\(n\)</span> is diagonalizable if and only if <span class="math inline">\(M\)</span> has <span class="math inline">\(n\)</span> independent eigenvectors. Moreover, <span class="math inline">\(M = PDP^{-1}\)</span>, where the columns of <span class="math inline">\(P\)</span> consist of the eigenvectors of <span class="math inline">\(M\)</span> and <span class="math inline">\(D\)</span> has the corresponding eigenvalues along the diagonal.</p>
<p>Using this, let’s create a matrix with given eigenvalues <span class="math inline">\(\lambda_1 = 3, \lambda_2 = 1\)</span> using <code>np.diag()</code>, and eigenvectors <span class="math inline">\(v_1 = [1,1]^T, v_2 = [1,-1]^T\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a>P <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="dv">1</span>],[<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>]])</span>
<span id="cb35-2"><a href="#cb35-2"></a>D <span class="op">=</span> np.diag((<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb35-3"><a href="#cb35-3"></a>M <span class="op">=</span> P <span class="op">@</span> D <span class="op">@</span> linalg.inv(P)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s verify that the eigenvalues of <span class="math inline">\(M\)</span> are 3 and 1:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:262,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683172771078,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="5cae3c7d-f6a5-4b39-dcb8-ae998f9e77a9">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a>evals, evecs <span class="op">=</span> linalg.eig(M)</span>
<span id="cb36-2"><a href="#cb36-2"></a>evals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>array([3.+0.j, 1.+0.j])</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="numerical-integration-with-scipy" class="level2" data-number="B.3">
<h2 data-number="B.3" class="anchored" data-anchor-id="numerical-integration-with-scipy"><span class="header-section-number">B.3</span> Numerical Integration with <code>SciPy</code></h2>
<section id="definite-integral" class="level3" data-number="B.3.1">
<h3 data-number="B.3.1" class="anchored" data-anchor-id="definite-integral"><span class="header-section-number">B.3.1</span> Definite integral</h3>
<p>The definite integral of a function <span class="math inline">\(f(x)\)</span> over an interval <span class="math inline">\([a,b]\)</span> is the limit</p>
<p><span class="math display">\[
\int_a^b f(x) \, dx = \lim_{N \to \infty} \sum_{i=1}^N f(x_i^ * ) (x_i - x_{i-1}) \ \ , \ x_i^* \in [x_{i-1},x_i]
\]</span></p>
<p>where, for each <span class="math inline">\(x_i\)</span>,</p>
<p><span class="math display">\[
x_0 = a &lt; x_1 &lt; \cdots &lt; x_N = b
\]</span></p>
<p>is a partition of <span class="math inline">\([a,b]\)</span> with <span class="math inline">\(N\)</span> subintervals, and the values <span class="math inline">\(x_i^ * \in [x_{i-1},x_i]\)</span> chosen in each subinterval are arbitrary. The definite integral represents the area under the curve of the graph of <span class="math inline">\(y=f(x)\)</span> on the interval <span class="math inline">\([a,b]\)</span>.</p>
<p><span class="math display">\[
\int_a^b f(x) \, dx = \text{area under the curve } y = f(x) \text{ on } [a,b]
\]</span></p>
<p>Note that the area above the <span class="math inline">\(x\)</span>-axis is considered positive, while the area below the <span class="math inline">\(x\)</span>-axis counts as negative area. For instance, we can visualize the integral:</p>
<p><span class="math display">\[
\int_{\pi/2}^{3\pi/2} \left( \sin(0.2 x) + \sin(2x)\right) dx
\]</span></p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:879,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683195775932,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="335471b5-9ab9-47fb-97a8-006ad80de9d9" data-execution_count="6">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: np.sin(<span class="fl">0.2</span><span class="op">*</span>x) <span class="op">+</span> np.sin(<span class="dv">2</span><span class="op">*</span>x)</span>
<span id="cb38-2"><a href="#cb38-2"></a></span>
<span id="cb38-3"><a href="#cb38-3"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span>np.pi,<span class="dv">100</span>)</span>
<span id="cb38-4"><a href="#cb38-4"></a>y <span class="op">=</span> f(x)</span>
<span id="cb38-5"><a href="#cb38-5"></a>plt.plot(x,y)</span>
<span id="cb38-6"><a href="#cb38-6"></a></span>
<span id="cb38-7"><a href="#cb38-7"></a>X <span class="op">=</span> np.linspace(np.pi<span class="op">/</span><span class="dv">2</span>,<span class="dv">3</span><span class="op">*</span>np.pi<span class="op">/</span><span class="dv">2</span>,<span class="dv">100</span>)</span>
<span id="cb38-8"><a href="#cb38-8"></a>Y <span class="op">=</span> f(X)</span>
<span id="cb38-9"><a href="#cb38-9"></a>plt.fill_between(X, <span class="dv">0</span>, Y, Y <span class="op">&gt;</span> <span class="dv">0</span>, color<span class="op">=</span><span class="st">'blue'</span>, alpha<span class="op">=</span><span class="fl">.25</span>)</span>
<span id="cb38-10"><a href="#cb38-10"></a>plt.fill_between(X, <span class="dv">0</span>, Y, Y <span class="op">&lt;</span> <span class="dv">0</span>, color<span class="op">=</span><span class="st">'red'</span>,  alpha<span class="op">=</span><span class="fl">.25</span>)</span>
<span id="cb38-11"><a href="#cb38-11"></a></span>
<span id="cb38-12"><a href="#cb38-12"></a>plt.xticks([np.pi<span class="op">/</span><span class="dv">2</span>,<span class="dv">3</span><span class="op">*</span>np.pi<span class="op">/</span><span class="dv">2</span>],[<span class="st">'$\pi/2$'</span>,<span class="st">'$3\pi/2$'</span>])</span>
<span id="cb38-13"><a href="#cb38-13"></a>plt.xlim([<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span>np.pi])<span class="op">;</span> plt.ylim([<span class="op">-</span><span class="dv">2</span>,<span class="dv">3</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="00_SciPy_files/figure-html/cell-22-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>In this case, the positive area and negative area are represented by blue and red colors, respectively. We can calculate the area using <code>scipy.integrate.quad()</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:363,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683196088450,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="b800fa3b-1190-4846-f842-8badf738f10e" data-execution_count="10">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a>integrate.quad(f, np.pi, np.pi<span class="op">*</span><span class="dv">3</span><span class="op">/</span><span class="dv">2</span>) <span class="co"># quad(f, a, b)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>(2.106158710412371, 2.3383058938146415e-14)</code></pre>
</div>
</div>
<p>The second item in the above <code>tuple</code> is the error. In introductory calculus courses, we typically concentrate on integrals that can be solved exactly using the Fundamental Theorem of Calculus, such as:</p>
<p><span class="math display">\[
\int_0^{\pi/2} \cos(x) \, dx = \sin(\pi/2) - \sin(0) = 1
\]</span></p>
<p>This result can be verified as follows:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:273,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683197064754,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="8535ec1b-d725-413c-8616-5ebe5539d370" data-execution_count="14">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: np.cos(x)</span>
<span id="cb41-2"><a href="#cb41-2"></a></span>
<span id="cb41-3"><a href="#cb41-3"></a>integrate.quad(f, <span class="dv">0</span>, np.pi<span class="op">/</span><span class="dv">2</span>) <span class="co"># quad(f, a, b)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>(0.9999999999999999, 1.1102230246251564e-14)</code></pre>
</div>
</div>
<p>Nevertheless, most definite integrals cannot be solved exactly. For instance, the well-known error function in probability</p>
<p><span class="math display">\[
\mathrm{erf}(x) = \frac{2}{\sqrt{\pi}} \int_0^x e^{-t^2} dt
\]</span></p>
<p>is a definite integral for which there is no explicit formula. In such cases, we can still compute the integral value using numerical integration:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:355,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683196785534,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="cf464d9f-cfa6-43f9-ee30-0cb8f1e58aba" data-execution_count="13">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: <span class="dv">2</span><span class="op">/</span>np.pi<span class="op">**</span>(<span class="fl">0.5</span>)<span class="op">*</span>np.exp(<span class="op">-</span>x<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb43-2"><a href="#cb43-2"></a></span>
<span id="cb43-3"><a href="#cb43-3"></a>integrate.quad(f, <span class="dv">0</span>, <span class="fl">1.96</span>) <span class="co"># quad(f, a, b)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>(0.9944262754648279, 1.1040349473132902e-14)</code></pre>
</div>
</div>
<p>If you’re interested in performing numerical differentiation, you can refer to the following libraries:</p>
<ol type="1">
<li>Findiff: <a href="https://github.com/maroba/findiff">https://github.com/maroba/findiff</a></li>
<li>Numdifftools: <a href="https://github.com/pbrod/numdifftools">https://github.com/pbrod/numdifftools</a></li>
</ol>
</section>
</section>
<section id="optimization" class="level2" data-number="B.4">
<h2 data-number="B.4" class="anchored" data-anchor-id="optimization"><span class="header-section-number">B.4</span> Optimization</h2>
<p>Optimization is the process of finding a numerical solution to a minimization or equality problem. The <code>scipy.optimize</code> module offers algorithms for function minimization (scalar or multi-dimensional), curve fitting, and root finding.</p>
<p>When optimizing input parameters for a function, <code>scipy.optimize</code> offers various helpful methods suitable for different types of functions:</p>
<ul>
<li><code>curve_fit()</code> for fitting a function to a set of data</li>
<li><code>minimize()</code> for minimizing a function of one variable or multiple variables</li>
<li><code>root()</code> for finding the zeros of a function of one variable or multiple variables</li>
</ul>
<p>In practice, all of these functions perform optimization in some form. The distinction lies in the type of function being optimized and the constraints applied to the optimization process.</p>
<section id="curve-fitting" class="level3" data-number="B.4.1">
<h3 data-number="B.4.1" class="anchored" data-anchor-id="curve-fitting"><span class="header-section-number">B.4.1</span> Curve fitting</h3>
<p>Suppose we have data on a sine wave, with some noise:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:356,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683198434313,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="6969c95d-cd67-4e54-859d-1a650eaca1bc" data-execution_count="19">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a>x_data <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, num<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb45-2"><a href="#cb45-2"></a>y_data <span class="op">=</span> <span class="fl">2.9</span> <span class="op">*</span> np.sin(<span class="fl">1.5</span> <span class="op">*</span> x_data) <span class="op">+</span> np.random.normal(size<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb45-3"><a href="#cb45-3"></a>plt.scatter(x_data, y_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>&lt;matplotlib.collections.PathCollection at 0x7f0fe5904370&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="00_SciPy_files/figure-html/cell-26-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>If we have data that we know follows a sine wave but are unsure of the amplitudes or the period, we can determine those values using least squares curve fitting. To begin, we need to define the test function to fit. In this case, it’s a sine function with unknown amplitude and period:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:428,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683198532332,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-execution_count="20">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw">def</span> test_func(x, a, b):</span>
<span id="cb47-2"><a href="#cb47-2"></a>    <span class="cf">return</span> a <span class="op">*</span> np.sin(b <span class="op">*</span> x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then use <code>scipy.optimize.curve_fit()</code> to find <code>a</code> and <code>b</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:279,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683198535237,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-execution_count="21">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a>params, params_covariance <span class="op">=</span> optimize.curve_fit(test_func, x_data, y_data, p0<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683198536726,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="4d5e0014-e4c5-43d7-db75-f1fc09f3d0bd" data-execution_count="22">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb49-2"><a href="#cb49-2"></a>plt.scatter(x_data, y_data, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb49-3"><a href="#cb49-3"></a>plt.plot(x_data, test_func(x_data, params[<span class="dv">0</span>], params[<span class="dv">1</span>]),</span>
<span id="cb49-4"><a href="#cb49-4"></a>         label<span class="op">=</span><span class="st">'Fitted function'</span>)</span>
<span id="cb49-5"><a href="#cb49-5"></a></span>
<span id="cb49-6"><a href="#cb49-6"></a>plt.legend(loc<span class="op">=</span><span class="st">'best'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>&lt;matplotlib.legend.Legend at 0x7f0fe59335e0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="00_SciPy_files/figure-html/cell-29-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="finding-the-minimum-of-a-scalar-function" class="level3" data-number="B.4.2">
<h3 data-number="B.4.2" class="anchored" data-anchor-id="finding-the-minimum-of-a-scalar-function"><span class="header-section-number">B.4.2</span> Finding the minimum of a scalar function</h3>
<p><code>scipy.optimize</code> also features the more versatile <code>minimize()</code> function. This function is capable of handling multivariate inputs and outputs and employs more advanced optimization algorithms to manage this complexity. Additionally, <code>minimize()</code> can accommodate constraints on the solution to your problem. Let’s explore a simple example to demonstrate its functionality:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:264,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683198593128,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-execution_count="23">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">10</span><span class="op">*</span>np.sin(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:455,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683198593952,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="8c0ce1c8-f0f3-4b92-c39c-f57bfedf13cc" data-execution_count="24">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1"></a>x <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.1</span>)</span>
<span id="cb52-2"><a href="#cb52-2"></a>plt.plot(x, f(x)) </span>
<span id="cb52-3"><a href="#cb52-3"></a>plt.show() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="00_SciPy_files/figure-html/cell-31-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>This function has a global minimum around -1.3 and a local minimum around 3.8. To search for the minimum, you can use <code>scipy.optimize.minimize()</code>. By providing a starting point <code>x0</code>, the function returns the location of the minimum it has discovered:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:818,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683199212571,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="3412701b-5698-4b7a-afd5-60dff32b8902" data-execution_count="29">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1"></a>result <span class="op">=</span> optimize.minimize(f, x0<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb53-2"><a href="#cb53-2"></a>xmin_global <span class="op">=</span> result.x</span>
<span id="cb53-3"><a href="#cb53-3"></a>result, <span class="bu">type</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>(  message: Optimization terminated successfully.
   success: True
    status: 0
       fun: -7.945823375615215
         x: [-1.306e+00]
       nit: 5
       jac: [-1.192e-06]
  hess_inv: [[ 8.589e-02]]
      nfev: 12
      njev: 6,
 scipy.optimize._optimize.OptimizeResult)</code></pre>
</div>
</div>
<p>The output of <code>minimize()</code> is an instance of the <code>OptimizeResult</code> class. This class gathers various relevant details from the optimizer’s run, including information on whether the optimization was successful or not. In this case, it finds the global minimum.</p>
<p>A potential issue with this approach is that if the function has local minima, the algorithm might find one of these local minima instead of the global minimum, depending on the choice of the initial point <code>x0</code>. This is because many optimization algorithms are sensitive to the starting point and can get trapped in local minima, preventing them from reaching the global minimum. For instance, let’s try to set <code>x0</code> to 3:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683199238170,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="f78a8eaa-0fb3-40cf-abab-d77cff3bed8e" data-execution_count="31">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1"></a>res <span class="op">=</span> optimize.minimize(f, x0<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb55-2"><a href="#cb55-2"></a>xmin_local <span class="op">=</span> res.x</span>
<span id="cb55-3"><a href="#cb55-3"></a>xmin_local</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>array([3.83746709])</code></pre>
</div>
</div>
<p>In this case, it finds the local minimum. Besides the starting point <code>x0</code>, we can constrain the variable to the interval <code>(0, 10)</code> using the <code>bounds</code> argument:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:293,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683198935625,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="08306ef1-a226-41c0-cb39-364e10d4ea86" data-execution_count="25">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1"></a>res <span class="op">=</span> optimize.minimize(f, x0<span class="op">=</span><span class="dv">1</span>, bounds<span class="op">=</span>((<span class="dv">0</span>,<span class="dv">10</span>),))</span>
<span id="cb57-2"><a href="#cb57-2"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>  message: CONVERGENCE: NORM_OF_PROJECTED_GRADIENT_&lt;=_PGTOL
  success: True
   status: 0
      fun: 0.0
        x: [ 0.000e+00]
      nit: 1
      jac: [ 1.000e+01]
     nfev: 4
     njev: 2
 hess_inv: &lt;1x1 LbfgsInvHessProduct with dtype=float64&gt;</code></pre>
</div>
</div>
<p>If the optimization was successful, then <code>fun</code> is the value of the objective function at the optimal value <code>x</code>. We can see from the output that, as expected, the minimum value at this range is <code>x = 0</code>.</p>
<p>As we may know, not every function has a minimum. For instance, if our objective function is <span class="math inline">\(y = x^3\)</span>, it will result in a <code>Desired error not necessarily achieved due to precision loss</code> because the optimizer eventually tries a number that is too big to be calculated by the computer.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:312,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683199082137,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="556c1516-4669-4a26-cb16-a98d32420f18" data-execution_count="26">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1"></a>f1 <span class="op">=</span> <span class="kw">lambda</span> x: x<span class="op">**</span><span class="dv">3</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>optimize.minimize(f1, x0<span class="op">=-</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>  message: Desired error not necessarily achieved due to precision loss.
  success: False
   status: 2
      fun: -1115932097.8874247
        x: [-1.037e+03]
      nit: 1
      jac: [ 3.228e+06]
 hess_inv: [[-3.204e-04]]
     nfev: 236
     njev: 112</code></pre>
</div>
</div>
</section>
<section id="finding-the-roots-of-a-scalar-function" class="level3" data-number="B.4.3">
<h3 data-number="B.4.3" class="anchored" data-anchor-id="finding-the-roots-of-a-scalar-function"><span class="header-section-number">B.4.3</span> Finding the roots of a scalar function</h3>
<p>To find a root, that is, a point where <span class="math inline">\(f(x) = 0\)</span>, of the function <span class="math inline">\(f\)</span> mentioned earlier, we can utilize <code>scipy.optimize.root()</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:274,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683199247306,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="4c8159f6-5afc-4729-97e9-c488e0528957" data-execution_count="33">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1"></a>root <span class="op">=</span> optimize.root(f, x0<span class="op">=</span><span class="dv">1</span>)  <span class="co"># our initial guess is 1</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>root</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code> message: The solution converged.
 success: True
  status: 1
     fun: [ 0.000e+00]
       x: [ 0.000e+00]
    nfev: 10
    fjac: [[-1.000e+00]]
       r: [-1.000e+01]
     qtf: [ 1.333e-32]</code></pre>
</div>
</div>
<p>Keep in mind that only one root is discovered. Examining the plot of <span class="math inline">\(f\)</span> indicates that there is a second root around -2.5. We can determine the exact value of this root by modifying our initial estimate:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683199248802,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="70d1186d-427c-47c8-a601-bb8aaac88c57" data-execution_count="34">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1"></a>root2 <span class="op">=</span> optimize.root(f, x0<span class="op">=-</span><span class="dv">2</span>)</span>
<span id="cb63-2"><a href="#cb63-2"></a>root2.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>array([-2.47948183])</code></pre>
</div>
</div>
<p>The following figure displays the roots and minimum we have identified up to this point:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:491,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683199249568,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="2571e261-5152-42f4-a4c7-f8fcbbe9ebb2" data-execution_count="35">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb65-2"><a href="#cb65-2"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">111</span>)</span>
<span id="cb65-3"><a href="#cb65-3"></a></span>
<span id="cb65-4"><a href="#cb65-4"></a><span class="co"># Plot the function</span></span>
<span id="cb65-5"><a href="#cb65-5"></a>ax.plot(x, f(x), <span class="st">'b-'</span>, label<span class="op">=</span><span class="st">"f(x)"</span>)</span>
<span id="cb65-6"><a href="#cb65-6"></a></span>
<span id="cb65-7"><a href="#cb65-7"></a><span class="co"># Plot the minima</span></span>
<span id="cb65-8"><a href="#cb65-8"></a>xmins <span class="op">=</span> np.array([xmin_global[<span class="dv">0</span>], xmin_local[<span class="dv">0</span>]])</span>
<span id="cb65-9"><a href="#cb65-9"></a>ax.plot(xmins, f(xmins), <span class="st">'go'</span>, label<span class="op">=</span><span class="st">"Minima"</span>)</span>
<span id="cb65-10"><a href="#cb65-10"></a></span>
<span id="cb65-11"><a href="#cb65-11"></a><span class="co"># Plot the roots</span></span>
<span id="cb65-12"><a href="#cb65-12"></a>roots <span class="op">=</span> np.array([root.x, root2.x])</span>
<span id="cb65-13"><a href="#cb65-13"></a>ax.plot(roots, f(roots), <span class="st">'kv'</span>, label<span class="op">=</span><span class="st">"Roots"</span>)</span>
<span id="cb65-14"><a href="#cb65-14"></a></span>
<span id="cb65-15"><a href="#cb65-15"></a><span class="co"># Decorate the figure</span></span>
<span id="cb65-16"><a href="#cb65-16"></a>ax.legend(loc<span class="op">=</span><span class="st">'best'</span>)</span>
<span id="cb65-17"><a href="#cb65-17"></a>ax.set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb65-18"><a href="#cb65-18"></a>ax.set_ylabel(<span class="st">'f(x)'</span>)</span>
<span id="cb65-19"><a href="#cb65-19"></a>ax.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb65-20"><a href="#cb65-20"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="00_SciPy_files/figure-html/cell-38-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="statistics" class="level2" data-number="B.5">
<h2 data-number="B.5" class="anchored" data-anchor-id="statistics"><span class="header-section-number">B.5</span> Statistics</h2>
<p>The <code>scipy.stats</code> module encompasses statistical tools and probabilistic representations of random processes.</p>
<section id="distributions-histogram-and-probability-density-function" class="level3" data-number="B.5.1">
<h3 data-number="B.5.1" class="anchored" data-anchor-id="distributions-histogram-and-probability-density-function"><span class="header-section-number">B.5.1</span> Distributions: histogram and probability density function</h3>
<p>Given observations of a random variable that adheres to a normal distribution:</p>
<div class="cell" data-outputid="1cc0fbbf-37c2-46c9-8821-687cbd6d36e0">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1"></a>samples <span class="op">=</span> np.random.normal(size<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb66-2"><a href="#cb66-2"></a>bins <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb66-3"><a href="#cb66-3"></a>bins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>array([-4, -3, -2, -1,  0,  1,  2,  3,  4])</code></pre>
</div>
</div>
<p>The histogram of these observations serves as an estimator of the random process’s PDF (probability density function):</p>
<div class="cell" data-outputid="b1e9df46-18fb-40a5-fab3-f9115a9de57a">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1"></a>histogram <span class="op">=</span> np.histogram(samples, bins<span class="op">=</span>bins, density<span class="op">=</span><span class="va">True</span>)[<span class="dv">0</span>]</span>
<span id="cb68-2"><a href="#cb68-2"></a>bins <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>(bins[<span class="dv">1</span>:] <span class="op">+</span> bins[:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb68-3"><a href="#cb68-3"></a>bins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>array([-3.5, -2.5, -1.5, -0.5,  0.5,  1.5,  2.5,  3.5])</code></pre>
</div>
</div>
<p>We can overlap the estimation with the actual PDF calculated using <code>scipy.stats.norm()</code>:</p>
<div class="cell" data-outputid="53583ca0-4cbc-47b1-e6af-5fa52b9f2b3f">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1"></a>pdf <span class="op">=</span> stats.norm.pdf(bins)  <span class="co"># norm is a distribution object</span></span>
<span id="cb70-2"><a href="#cb70-2"></a>plt.plot(bins, histogram, label<span class="op">=</span><span class="st">"Histogram of samples"</span>)</span>
<span id="cb70-3"><a href="#cb70-3"></a>plt.plot(bins, pdf, label<span class="op">=</span><span class="st">"PDF"</span>)</span>
<span id="cb70-4"><a href="#cb70-4"></a>plt.legend()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="00_SciPy_files/figure-html/cell-41-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>We can see that the estimate using histogram is quite close to the true PDF.</p>
</section>
<section id="hypothesis-testing" class="level3" data-number="B.5.2">
<h3 data-number="B.5.2" class="anchored" data-anchor-id="hypothesis-testing"><span class="header-section-number">B.5.2</span> Hypothesis testing</h3>
<p>A statistical test is a decision indicator. For instance, if we have two sets of observations, that we assume are generated from Gaussian processes:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:706,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683198023612,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="c9bad9bd-2743-4090-d521-65de300f7e9a" data-execution_count="17">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1"></a><span class="co"># Generates 2 sets of observations</span></span>
<span id="cb71-2"><a href="#cb71-2"></a>samples1 <span class="op">=</span> np.random.normal(<span class="dv">0</span>, size<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb71-3"><a href="#cb71-3"></a>samples2 <span class="op">=</span> np.random.normal(<span class="dv">1</span>, size<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb71-4"><a href="#cb71-4"></a></span>
<span id="cb71-5"><a href="#cb71-5"></a><span class="co"># Compute a histogram of the sample</span></span>
<span id="cb71-6"><a href="#cb71-6"></a>bins <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">30</span>)</span>
<span id="cb71-7"><a href="#cb71-7"></a>histogram1, bins <span class="op">=</span> np.histogram(samples1, bins<span class="op">=</span>bins, density<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb71-8"><a href="#cb71-8"></a>histogram2, bins <span class="op">=</span> np.histogram(samples2, bins<span class="op">=</span>bins, density<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb71-9"><a href="#cb71-9"></a></span>
<span id="cb71-10"><a href="#cb71-10"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb71-11"><a href="#cb71-11"></a>plt.hist(samples1, bins<span class="op">=</span>bins, density<span class="op">=</span><span class="va">True</span>, label<span class="op">=</span><span class="st">"Samples 1"</span>)</span>
<span id="cb71-12"><a href="#cb71-12"></a>plt.hist(samples2, bins<span class="op">=</span>bins, density<span class="op">=</span><span class="va">True</span>, label<span class="op">=</span><span class="st">"Samples 2"</span>)</span>
<span id="cb71-13"><a href="#cb71-13"></a>plt.legend(loc<span class="op">=</span><span class="st">'best'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>&lt;matplotlib.legend.Legend at 0x7f0fe5b07df0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="00_SciPy_files/figure-html/cell-42-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>We can use a T-test using <code>scipy.stats.ttest_ind()</code> to decide whether the means of two sets of observations are significantly different:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683198025103,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="f0d95f55-862d-4210-c54c-5495ea3156fc" data-execution_count="18">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1"></a>stats.ttest_ind(samples1, samples2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>Ttest_indResult(statistic=-4.547017710744573, pvalue=1.5576418947888603e-05)</code></pre>
</div>
</div>
<p>The resulting output is composed of: - The <code>T</code> statistic value: it is a number the sign of which is proportional to the difference between the two random processes and the magnitude is related to the significance of this difference. - The <code>p</code> value: the probability of both processes being identical. If it is close to 1, the two process are almost certainly identical. The closer it is to zero, the more likely it is that the processes have different means.</p>
<p>For the above test, we can reject the null hypotheis that these two samples have the same mean.</p>
<p>All in all, <code>SciPy</code> is an open-source library designed for scientific computing in Python. It builds upon the core functionality provided by the <code>NumPy</code> and offers a comprehensive suite of additional tools for various scientific domains, including linear algebra, optimization, statistics and more. <code>SciPy</code> is widely used in research, education, and industry for applications in fields like physics, engineering, and data science. Its extensive documentation, active community, and frequent updates make it an essential tool for anyone working with numerical computations in <code>Python</code>.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./00_Copilot.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Increase productivity and learning with Github Copilot in Python</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04_Algorithms_sol.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Algorithms</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>