<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.306">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="phonchi">
<meta name="dcterms.date" content="2023-05-19">

<title>Computer Programming - 11&nbsp; Symbolic Mathematics in Python with SymPy</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./00_Copilot.html" rel="next">
<link href="./12_Matplotlib.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./13_SymPy.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Symbolic Mathematics in Python with `SymPy`</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Computer Programming</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Python Basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Flow_control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Flow Control</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Lists_tuples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Lists and Tuples</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Dictionaries_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Other collections - Dictionaries and Sets</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Manipulating_string.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Manipulating Strings</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_Files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Files and Exceptions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_09_OOP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Object Oriented Programming and Classes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_11_NumPy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Array-Oriented Programming with NumPy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_Matplotlib.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Visualization with <code>Matplotlib</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_SymPy.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Symbolic Mathematics in Python with <code>SymPy</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_Copilot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Increase productivity and learning with Github Copilot in Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_SciPy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">High-level scientific computing with <code>SciPy</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Algorithms_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Algorithms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Data_Structure_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Data Structure</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Abstract_data_types_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Abstract Data Types</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 1_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Assignment 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 2_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Assignment 2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 3_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Assignment 3</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 4_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Assignment 4</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 5_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Assignment 5</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 6_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Assignment 6</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 7_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Assignment 7</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 8_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">M</span>&nbsp; <span class="chapter-title">Assignment 8</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 9_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">N</span>&nbsp; <span class="chapter-title">Assignment 9</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Quiz1_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">O</span>&nbsp; <span class="chapter-title">Quiz 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Quiz2_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">P</span>&nbsp; <span class="chapter-title">Quiz 2</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">11.1</span> Introduction</a></li>
  <li><a href="#using-sympy-as-a-calculator" id="toc-using-sympy-as-a-calculator" class="nav-link" data-scroll-target="#using-sympy-as-a-calculator"><span class="header-section-number">11.2</span> Using <code>SymPy</code> as a calculator</a></li>
  <li><a href="#defining-symbols-and-perform-symbolic-operations" id="toc-defining-symbols-and-perform-symbolic-operations" class="nav-link" data-scroll-target="#defining-symbols-and-perform-symbolic-operations"><span class="header-section-number">11.3</span> Defining symbols and perform symbolic operations</a></li>
  <li><a href="#solving-equations-symbolically" id="toc-solving-equations-symbolically" class="nav-link" data-scroll-target="#solving-equations-symbolically"><span class="header-section-number">11.4</span> Solving equations symbolically</a>
  <ul class="collapse">
  <li><a href="#solving-a-system-of-linear-equations" id="toc-solving-a-system-of-linear-equations" class="nav-link" data-scroll-target="#solving-a-system-of-linear-equations"><span class="header-section-number">11.4.1</span> Solving a system of linear equations</a></li>
  </ul></li>
  <li><a href="#plotting-using-sympy" id="toc-plotting-using-sympy" class="nav-link" data-scroll-target="#plotting-using-sympy"><span class="header-section-number">11.5</span> Plotting using <code>SymPy</code></a></li>
  <li><a href="#calculus-with-sympy" id="toc-calculus-with-sympy" class="nav-link" data-scroll-target="#calculus-with-sympy"><span class="header-section-number">11.6</span> Calculus with <code>SymPy</code></a>
  <ul class="collapse">
  <li><a href="#series-expansion" id="toc-series-expansion" class="nav-link" data-scroll-target="#series-expansion"><span class="header-section-number">11.6.1</span> Series expansion</a></li>
  <li><a href="#lambdify" id="toc-lambdify" class="nav-link" data-scroll-target="#lambdify"><span class="header-section-number">11.6.2</span> <code>lambdify()</code></a></li>
  <li><a href="#limits" id="toc-limits" class="nav-link" data-scroll-target="#limits"><span class="header-section-number">11.6.3</span> Limits</a></li>
  <li><a href="#finding-the-derivative-of-functions" id="toc-finding-the-derivative-of-functions" class="nav-link" data-scroll-target="#finding-the-derivative-of-functions"><span class="header-section-number">11.6.4</span> Finding the derivative of functions</a></li>
  <li><a href="#finding-the-integrals-of-functions" id="toc-finding-the-integrals-of-functions" class="nav-link" data-scroll-target="#finding-the-integrals-of-functions"><span class="header-section-number">11.6.5</span> Finding the integrals of functions</a></li>
  </ul></li>
  <li><a href="#linear-algebra-with-sympy" id="toc-linear-algebra-with-sympy" class="nav-link" data-scroll-target="#linear-algebra-with-sympy"><span class="header-section-number">11.7</span> Linear algebra with <code>SymPy</code></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Symbolic Mathematics in Python with <code>SymPy</code></span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>phonchi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 19, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>


<table align="left">
<tbody><tr><td>
<a href="https://colab.research.google.com/github/phonchi/nsysu-math106A/blob/master/static_files/presentations/13_SymPy.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a>
</td>
<td>
<a target="_blank" href="https://kaggle.com/kernels/welcome?src=https://github.com/phonchi/nsysu-math106A/blob/master/static_files/presentations/13_SymPy.ipynb"><img src="https://kaggle.com/static/images/open-in-kaggle.svg"></a>
</td>

</tr></tbody></table>
<p><br></p>
<section id="introduction" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">11.1</span> Introduction</h2>
<p><code>SymPy</code> is a Python library designed for symbolic mathematics. Its goal is to serve as an alternative to systems like Mathematica, Maple, or Sage while maintaining a simple and easily extensible codebase. <code>SymPy</code> is written entirely in <code>Python</code> and does not necessitate any external libraries.</p>
<p>The standard way of importing the module is:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1686,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683272725469,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="91be8eef-fc4c-4b8b-e48f-a0780938aece" data-execution_count="3">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a>package_name <span class="op">=</span> <span class="st">"sympy"</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="cf">try</span>:</span>
<span id="cb1-4"><a href="#cb1-4"></a>    <span class="bu">__import__</span>(package_name)</span>
<span id="cb1-5"><a href="#cb1-5"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>package_name<span class="sc">}</span><span class="ss"> is already installed."</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="cf">except</span> <span class="pp">ImportError</span>:</span>
<span id="cb1-7"><a href="#cb1-7"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>package_name<span class="sc">}</span><span class="ss"> not found. Installing..."</span>)</span>
<span id="cb1-8"><a href="#cb1-8"></a>    <span class="op">%</span>pip install {package_name}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>sympy is already installed.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb3-2"><a href="#cb3-2"></a>sp.init_printing()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When you call <code>sp.init_printing()</code>, it sets up your session to be able to print <code>SymPy</code> objects in a more visually appealing and understandable way.</p>
</section>
<section id="using-sympy-as-a-calculator" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="using-sympy-as-a-calculator"><span class="header-section-number">11.2</span> Using <code>SymPy</code> as a calculator</h2>
<p>The core module in the <code>SymPy</code> package includes the <code>Number</code> class, which represents atomic numbers. This class has two subclasses: the <code>Float</code> and <code>Rational</code> classes. The <code>Rational</code> class is further extended by the <code>Integer</code> class. First, let’s create an Integer object from <code>SymPy</code> and perform some calculations:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683272748428,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="0ccc771a-e429-46e6-8eca-2ddc7a082356" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>u <span class="op">=</span> sp.Integer(<span class="dv">24</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>u<span class="op">/</span><span class="dv">8</span>, u<span class="op">/</span><span class="dv">7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<p><span class="math inline">\(\displaystyle \left( 3, \  \frac{24}{7}\right)\)</span></p>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="bu">type</span>(u<span class="op">/</span><span class="dv">8</span>), <span class="bu">type</span>(u<span class="op">/</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>(sympy.core.numbers.Integer, sympy.core.numbers.Rational)</code></pre>
</div>
</div>
<p>As demonstrated, if an exact result can be obtained, <code>SymPy</code> will return it. If not, <code>SymPy</code> will provide an expression instead.</p>
<p>The <code>Rational</code> class represents a rational number as a pair of two <code>Integers</code>: the numerator and the denominator. Thus, <code>Rational(1, 2)</code> represents 1/2, <code>Rational(5, 2)</code> represents 5/2, and so on:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:843,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683272791239,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="d61c2db4-edab-4de2-a325-6205063cee6a" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>a <span class="op">=</span> sp.Rational(<span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>a, a<span class="op">*</span><span class="dv">6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<p><span class="math inline">\(\displaystyle \left( \frac{1}{3}, \  2\right)\)</span></p>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="bu">type</span>(a), <span class="bu">type</span>(a<span class="op">*</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>(sympy.core.numbers.Rational, sympy.core.numbers.Integer)</code></pre>
</div>
</div>
<p>Lastly, there is a <code>Float</code> class that can represent a floating-point number with arbitrary precision:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683273224767,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="6131521b-ec8c-4671-ccfa-379fb3626f66" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="bu">print</span>(sp.Float(<span class="fl">3.53</span>) <span class="op">+</span> sp.Float(<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>6.53000000000000</code></pre>
</div>
</div>
<p>Note that this is in contrast to normal <code>Python</code> where we may get approximated results:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683272878889,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="42cdaa45-896a-4854-87db-84f2baa2155c" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="bu">print</span>(<span class="fl">3.53</span> <span class="op">+</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>6.529999999999999</code></pre>
</div>
</div>
<p>For more about the discussion of floating point math, see <a href="https://0.30000000000000004.com/">here</a> or <a href="https://docs.python.org/3/library/decimal.html">here</a> for more information.</p>
<p>In addition to the numerical classes, <code>SymPy</code> features constant objects, such as <code>pi</code>, <code>E</code>, <code>oo</code> (infinity) and others. <code>SymPy</code> employs <a href="https://mpmath.org/">mpmath</a> in the background, enabling computations using arbitrary-precision arithmetic. Consequently, certain special constants, like <span class="math inline">\(e\)</span>, <span class="math inline">\(\pi\)</span>, and <span class="math inline">\(\infty\)</span>, can also be evaluated:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:413,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683273147175,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="ef8c33b3-4e2d-43f7-d2bb-3194c42311ce" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>sp.pi<span class="op">**</span><span class="dv">2</span>, sp.pi.evalf()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<p><span class="math inline">\(\displaystyle \left( \pi^{2}, \  3.14159265358979\right)\)</span></p>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683273149543,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="ee6fb4b6-8a2b-47d6-cba4-c2e4cd14b42e" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>(sp.pi <span class="op">+</span> sp.E).evalf()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<p><span class="math inline">\(\displaystyle 5.85987448204884\)</span></p>
</div>
</div>
<p>As demonstrated, the <code>evalf()</code> method can be used to evaluate an expression as a floating-point number. To evaluate results with arbitrary precision, simply pass the desired number of digits to the <code>evalf()</code> method:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:507,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683273180467,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="ea17cbee-fc36-4970-e227-844ef704ca73" data-execution_count="13">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>sqrt2 <span class="op">=</span> sp.sqrt(<span class="dv">2</span>).evalf(<span class="dv">100</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>sqrt2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<p><span class="math inline">\(\displaystyle 1.414213562373095048801688724209698078569671875376948073176679737990732478462107038850387534327641573\)</span></p>
</div>
</div>
<p>As we have mentioned, there is also a object representing mathematical infinity called <code>oo</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:419,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683273404123,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="632ca21c-8662-428e-bb66-835e5c81dd34" data-execution_count="14">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>sp.oo <span class="op">&gt;</span> <span class="dv">99999</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<p><span class="math inline">\(\displaystyle \text{True}\)</span></p>
</div>
</div>
<p>Finally, we also have other common functions like <code>sin</code>, <code>cos</code>, <code>tan</code>, <code>exp</code>, <code>log</code>, etc. in <code>SymPy</code>:</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a>sp.sin(sp.pi<span class="op">/</span><span class="dv">2</span>), sp.exp(<span class="dv">0</span>), sp.log(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<p><span class="math inline">\(\displaystyle \left( 1, \  1, \  0\right)\)</span></p>
</div>
</div>
</section>
<section id="defining-symbols-and-perform-symbolic-operations" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="defining-symbols-and-perform-symbolic-operations"><span class="header-section-number">11.3</span> Defining symbols and perform symbolic operations</h2>
<p><strong><em>Symbols</em></strong> serve as the foundation of symbolic math. When we write the statement <span class="math inline">\(x + x + 1\)</span>, Python evaluates it, resulting in a numerical value. But what if we want the result in terms of the symbol <span class="math inline">\(x\)</span>? <code>SymPy</code> enables us to write programs where we can express and evaluate mathematical expressions using such symbols. First, we import the <code>Symbol</code> class from <code>SymPy</code> and create an object of this class, passing <code>'x'</code> as a parameter:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:396,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683273468477,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="996f2de1-32da-4eaa-a0e0-86a477e597e9" data-execution_count="16">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">'x'</span>) <span class="co"># the symbol you create has to be specified as a string</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>x <span class="op">+</span> x <span class="op">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<p><span class="math inline">\(\displaystyle 2 x + 1\)</span></p>
</div>
</div>
<p>After defining symbols, you can perform basic mathematical operations on them using the same operators you’re already familiar with:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1296,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683273488586,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="8768dd66-8b36-4b2e-f491-56b0290e601e" data-execution_count="17">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a>x,y <span class="op">=</span> sp.symbols(<span class="st">'x,y'</span>) <span class="co"># you can create multiple symbols at once using multiple assignment</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>p <span class="op">=</span> (x <span class="op">+</span> <span class="dv">3</span>)<span class="op">*</span>(y<span class="op">/</span><span class="dv">3</span><span class="op">+</span>x)</span>
<span id="cb20-3"><a href="#cb20-3"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<p><span class="math inline">\(\displaystyle \left(x + 3\right) \left(x + \frac{y}{3}\right)\)</span></p>
</div>
</div>
<p>Note that <code>symbols()</code> is a function while <code>Symbol</code> is a class!</p>
<p>You might have anticipated that <code>SymPy</code> would multiply everything out. However, <code>SymPy</code> only automatically simplifies the most elementary expressions and requires the programmer to explicitly request further simplification. To expand an expression, utilize the <code>expand()</code> function:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683273531522,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="2676f9bf-17e6-49a9-8b6c-a36bcbe87410" data-execution_count="18">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a>p2 <span class="op">=</span> sp.expand(p)</span>
<span id="cb21-2"><a href="#cb21-2"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<p><span class="math inline">\(\displaystyle x^{2} + \frac{x y}{3} + 3 x + y\)</span></p>
</div>
</div>
<p>You can also factor expressions using the <code>factor()</code> function:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1017,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683273541157,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="264295ab-d51b-4160-975f-8d9853dfb1df" data-execution_count="19">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>sp.factor(p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<p><span class="math inline">\(\displaystyle \frac{\left(x + 3\right) \left(3 x + y\right)}{3}\)</span></p>
</div>
</div>
<p>The terms are organized in the order of <code>x</code> powers, from highest to lowest. If you prefer the expression in the reverse order, with the highest power of <code>x</code> appearing last, you can achieve that using the <code>init_printing()</code> function, as shown below:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683113848317,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="6e53db53-24e3-4140-f7ac-007cc10e9be0" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a>sp.init_printing(order<span class="op">=</span><span class="st">'rev-lex'</span>)</span>
<span id="cb23-2"><a href="#cb23-2"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<p><span class="math inline">\(\displaystyle y + 3 x + \frac{x y}{3} + x^{2}\)</span></p>
</div>
</div>
<p>The above code demonstrates that we want <code>SymPy</code> to display the expressions in reverse lexicographical order. In this instance, the keyword argument instructs <code>Python</code> to print terms with lower powers first.</p>
<p>We can also employ <code>SymPy</code> to substitute values into an expression. This allows us to compute the value of the expression for specific variable values. Take the mathematical expression <span class="math inline">\(x^2 + 2xy + y^2\)</span>, which can be defined as follows:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1025,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683273622448,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="227c2527-9e00-40cd-8269-9622e5e1013f" data-execution_count="21">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a>sp.init_printing(order<span class="op">=</span><span class="st">'lex'</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a>p3 <span class="op">=</span> x<span class="op">*</span>x <span class="op">+</span> x<span class="op">*</span>y <span class="op">+</span> x<span class="op">*</span>y <span class="op">+</span> y<span class="op">*</span>y</span>
<span id="cb24-3"><a href="#cb24-3"></a>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<p><span class="math inline">\(\displaystyle x^{2} + 2 x y + y^{2}\)</span></p>
</div>
</div>
<p>To evaluate this expression, you can substitute numbers for the symbols by using the <code>subs()</code> method:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683273638044,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="696ad4a1-0373-4103-cc64-fc1c3826b839" data-execution_count="22">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a>p3.subs({x:<span class="dv">1</span>, y:<span class="dv">2</span>}) <span class="co"># We use dictionary to specify the values of x and y</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<p><span class="math inline">\(\displaystyle 9\)</span></p>
</div>
</div>
<p>Additionally, you can express one symbol in terms of another and perform substitutions accordingly, using the <code>subs()</code> method. For instance, if you know that <span class="math inline">\(x = 1 - y\)</span>, this is how you could evaluate the previous expression:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:866,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683273664310,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="bf90a8e8-1d8c-4c60-fda3-5079b728c121" data-execution_count="23">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>p3.subs({x:<span class="dv">1</span><span class="op">-</span>y})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<p><span class="math inline">\(\displaystyle y^{2} + 2 y \left(- y + 1\right) + \left(- y + 1\right)^{2}\)</span></p>
</div>
</div>
<p>If you desire a more simplified result — for example, if there are terms that cancel each other out — you can utilize <code>SymPy</code>’s <code>simplify()</code> function:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683273686777,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="04d39632-81cc-4a70-95b6-abc7c0fca5db" data-execution_count="24">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>sp.simplify(p3.subs({x:<span class="dv">1</span><span class="op">-</span>y})) <span class="co"># The result turns out to be 1 because the other terms of the expression cancel each other.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<p><span class="math inline">\(\displaystyle 1\)</span></p>
</div>
</div>
<p>This example reiterates that <code>SymPy</code> will not perform any complex simplification unless explicitly requested to do so.</p>
<blockquote class="blockquote">
<h3 id="exercise-1-try-to-solve-the-following-problems-using-sympy" data-number="11.3.1" class="anchored"><span class="header-section-number">11.3.1</span> Exercise 1: Try to solve the following problems using <code>SymPy</code>:</h3>
<p>Expand the following expression: <span class="math inline">\(\sin(4x)\cos(5x)\)</span> so that the final results only contains <code>sin(x)</code> and its power term (<span class="math inline">\(\sin^n(x)\)</span>).</p>
</blockquote>
<p>Hint: You can use <code>simplify()</code>, <code>subs()</code> and <code>expand()</code> function to simplify the expression. You may find keyowrd <code>trig=True</code> argument in <code>expand()</code> function useful. Finally, if you want to perform symbolic manipulation, be sure to use functions in <code>SymPy</code>.</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># Your code here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="solving-equations-symbolically" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="solving-equations-symbolically"><span class="header-section-number">11.4</span> Solving equations symbolically</h2>
<p><code>SymPy</code>’s <code>solve()</code> function can be employed to find solutions to equations. When you input an expression with a symbol representing a variable, such as <code>x</code>, <code>solve()</code> computes the value of that symbol. This function always performs its calculation by assuming the expression you enter is equal to zero — that is, it outputs the value that, when substituted for the symbol, makes the entire expression equal zero.</p>
<p>Let’s start with the simple equation <span class="math inline">\(x - 5 = 7\)</span>. If we want to use <code>solve()</code> to find the value of <code>x</code>, we first need to make one side of the equation equal zero (<span class="math inline">\(x - 5 - 7 = 0\)</span>). Then, we’re ready to use <code>solve()</code>, as shown below:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:474,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683273807010,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="8259ea70-de88-4ccb-da08-37863c97a917" data-execution_count="26">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">'x'</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>expr <span class="op">=</span> x <span class="op">-</span> <span class="dv">5</span> <span class="op">-</span> <span class="dv">7</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>sp.solve(expr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<p><span class="math inline">\(\displaystyle \left[ 12\right]\)</span></p>
</div>
</div>
<p>Observe that the result 12 is returned within a list. An equation can have multiple solutions — for instance, a quadratic equation has two solutions. In such cases, the <code>list</code> will include all the solutions as its elements. Let’s look at an example:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683277995269,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="40184aeb-2470-4314-9407-834c9a87ab07" data-execution_count="27">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">'x'</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a>expr <span class="op">=</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">5</span><span class="op">*</span>x <span class="op">+</span> <span class="dv">4</span></span>
<span id="cb30-3"><a href="#cb30-3"></a>sp.solve(expr), sp.solve(expr, <span class="bu">dict</span><span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<p><span class="math inline">\(\displaystyle \left( \left[ -4, \  -1\right], \  \left[ \left\{ x : -4\right\}, \  \left\{ x : -1\right\}\right]\right)\)</span></p>
</div>
</div>
<p>It’s worth noting that we can set <code>dict=True</code> as an argument to retrieve a <code>dictionary</code> instead of a <code>list</code>.</p>
<p>In addition to finding the roots of equations, we can leverage symbolic math to utilize the <code>solve()</code> function to express one variable in an equation in terms of the others. Let’s examine finding the roots for the general quadratic equation <span class="math inline">\(ax^2 + bx + c = 0\)</span>. To accomplish this, we’ll define <code>x</code> and three additional symbols — <code>a</code>, <code>b</code>, and <code>c</code>, which correspond to the three coefficients:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:386,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683278136731,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="32e696bc-48b6-4e8e-d0b7-e6b91ab4cd05" data-execution_count="28">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">'x'</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a>a <span class="op">=</span> sp.Symbol(<span class="st">'a'</span>)</span>
<span id="cb31-3"><a href="#cb31-3"></a>b <span class="op">=</span> sp.Symbol(<span class="st">'b'</span>)</span>
<span id="cb31-4"><a href="#cb31-4"></a>c <span class="op">=</span> sp.Symbol(<span class="st">'c'</span>)</span>
<span id="cb31-5"><a href="#cb31-5"></a></span>
<span id="cb31-6"><a href="#cb31-6"></a>expr <span class="op">=</span> a<span class="op">*</span>x<span class="op">*</span>x <span class="op">+</span> b<span class="op">*</span>x <span class="op">+</span> c</span>
<span id="cb31-7"><a href="#cb31-7"></a>sp.solve(expr, x, <span class="bu">dict</span><span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<p><span class="math inline">\(\displaystyle \left[ \left\{ x : \frac{- b - \sqrt{- 4 a c + b^{2}}}{2 a}\right\}, \  \left\{ x : \frac{- b + \sqrt{- 4 a c + b^{2}}}{2 a}\right\}\right]\)</span></p>
</div>
</div>
<p>In this example, we must include an additional argument, <code>x</code>, to the <code>solve()</code> function. Because there’s more than one symbol in the equation, we need to inform <code>solve()</code> which symbol it should solve for, which we indicate by passing in <code>x</code> as the second argument. As anticipated, <code>solve()</code> outputs the quadratic formula: the general formula for determining the value(s) of <code>x</code> in a polynomial expression.</p>
<p>We can also sove the expression using <code>nsolve()</code> function. <code>nsolve()</code> function is a numerical solver that uses numerical methods to find the roots of an equation given a starting point. For example, we can solve the equation <span class="math inline">\(x^2 - 2 = 0\)</span> using <code>nsolve()</code> function:</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">'x'</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a>expr <span class="op">=</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">2</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>sp.nsolve(expr, <span class="op">-</span><span class="dv">1</span>), sp.nsolve(expr, <span class="dv">1</span>), sp.solve(expr) <span class="co"># -1 and 1 are the starting points</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<p><span class="math inline">\(\displaystyle \left( -1.4142135623731, \  1.4142135623731, \  \left[ - \sqrt{2}, \  \sqrt{2}\right]\right)\)</span></p>
</div>
</div>
<section id="solving-a-system-of-linear-equations" class="level3" data-number="11.4.1">
<h3 data-number="11.4.1" class="anchored" data-anchor-id="solving-a-system-of-linear-equations"><span class="header-section-number">11.4.1</span> Solving a system of linear equations</h3>
<p>Consider the following two equations:</p>
<p><span class="math display">\[
\begin{align}
2x + 3y &amp;= 6 \\
3x + 2y &amp;= 12
\end{align}
\]</span></p>
<p>Suppose we want to find the pair of values <code>(x, y)</code> that satisfies both equations. We can use the <code>solve()</code> function to find the solution for a system of equations like this one. First, we define the two symbols and construct the two equations:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:654,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683279858775,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="8de2358b-f10c-48de-f4cd-a0c4473d2740" data-execution_count="30">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">'x'</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a>y <span class="op">=</span> sp.Symbol(<span class="st">'y'</span>)</span>
<span id="cb33-3"><a href="#cb33-3"></a>expr1 <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>x <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>y <span class="op">-</span> <span class="dv">6</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>expr2 <span class="op">=</span> <span class="dv">3</span><span class="op">*</span>x <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>y <span class="op">-</span> <span class="dv">12</span></span>
<span id="cb33-5"><a href="#cb33-5"></a></span>
<span id="cb33-6"><a href="#cb33-6"></a>sp.solve((expr1, expr2), <span class="bu">dict</span><span class="op">=</span><span class="va">True</span>) <span class="co"># Enclose the equations in a tuple</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<p><span class="math inline">\(\displaystyle \left[ \left\{ x : \frac{24}{5}, \  y : - \frac{6}{5}\right\}\right]\)</span></p>
</div>
</div>
<p>Observe how we’ve rearranged the expressions so that they both equal zero. Retrieving the solution as a dictionary is beneficial in this scenario because we can verify whether the solution we obtained indeed satisfies the equations:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1170,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683279898628,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="460c9c11-ea7c-4b2e-a7e4-e63e55bc92b9" data-execution_count="31">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>sol <span class="op">=</span> sp.solve((expr1, expr2), <span class="bu">dict</span><span class="op">=</span><span class="va">True</span>)</span>
<span id="cb34-2"><a href="#cb34-2"></a>expr1.subs({x:sol[<span class="dv">0</span>][x], y:sol[<span class="dv">0</span>][y]}), expr2.subs({x:sol[<span class="dv">0</span>][x], y:sol[<span class="dv">0</span>][y]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<p><span class="math inline">\(\displaystyle \left( 0, \  0\right)\)</span></p>
</div>
</div>
<p>The output of substituting the values of <code>x</code> and <code>y</code> corresponding to the solution in the two expressions is zero, which confirms that the solution satisfies both equations.</p>
<p>If we’re unable to obtain the exact solution, we can still obtain the numerical solution using the <code>nroots()</code> function:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:565,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683279943891,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="1701c0bf-590d-4ce2-8aaa-7c7544823217" data-execution_count="32">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a>expr1 <span class="op">=</span> x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>x<span class="op">**</span><span class="dv">2</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>sp.solve(expr1), sp.nroots(expr1, n<span class="op">=</span><span class="dv">3</span>) <span class="co"># n is the number of digits to calculate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<p><span class="math inline">\(\displaystyle \left( \left[ -1, \  - \frac{1}{2} + \frac{\sqrt{5}}{2}, \  - \frac{\sqrt{5}}{2} - \frac{1}{2}\right], \  \left[ -1.62, \  -1.0, \  0.618\right]\right)\)</span></p>
</div>
</div>
</section>
</section>
<section id="plotting-using-sympy" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="plotting-using-sympy"><span class="header-section-number">11.5</span> Plotting using <code>SymPy</code></h2>
<p>With <code>SymPy</code>, you can simply provide the equation of the line you wish to plot, and <code>SymPy</code> will create the graph for you. Let’s plot a line whose equation is given by <span class="math inline">\(y = 2x + 3\)</span>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1284,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683281743277,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="a458c277-bd66-4393-a3fd-1f92118e9290" data-execution_count="33">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">'x'</span>)</span>
<span id="cb36-2"><a href="#cb36-2"></a>sp.plot(<span class="dv">2</span><span class="op">*</span>x<span class="op">+</span><span class="dv">3</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="13_SymPy_files/figure-html/cell-32-output-1.png" class="img-fluid"></p>
</div>
</div>
<blockquote class="blockquote">
<p>The graph reveals that a default range of <code>x</code> values was automatically selected: −10 to 10. In reality, <code>SymPy</code> employs <code>matplotlib</code> in the background to generate the graphs.</p>
</blockquote>
<p>Suppose you wanted to constrain the values of <code>x</code> in the previous graph to lie within the range of −5 to 5. Additionally, we can use other keyword arguments in the <code>plot()</code> function, such as <code>title</code> to specify a title or <code>xlabel</code> and <code>ylabel</code> to label the x-axis and the y-axis, respectively. Here’s how to accomplish this:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:567,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683281794099,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="49f521b5-fc72-480c-8aa2-7cf676243788" data-execution_count="34">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a>sp.plot(<span class="dv">2</span><span class="op">*</span>x <span class="op">+</span> <span class="dv">3</span>, (x, <span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>), title<span class="op">=</span><span class="st">'A Line'</span>, xlabel<span class="op">=</span><span class="st">'x'</span>, ylabel<span class="op">=</span><span class="st">'2x+3'</span>)<span class="op">;</span> <span class="co">#(symbol, start, end) to specify the range</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="13_SymPy_files/figure-html/cell-33-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>You can plot more than one expression on the same graph by providing multiple expressions when calling the <code>SymPy</code> <code>plot()</code> function. Here’s the code:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1427,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683281815753,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="d7670315-f7a3-4a74-8c70-abd2f0cb496a" data-execution_count="35">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">'x'</span>)</span>
<span id="cb38-2"><a href="#cb38-2"></a>p <span class="op">=</span> sp.plot(<span class="dv">2</span><span class="op">*</span>x<span class="op">+</span><span class="dv">3</span>, <span class="dv">3</span><span class="op">*</span>x<span class="op">+</span><span class="dv">1</span>, legend<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb38-3"><a href="#cb38-3"></a>p[<span class="dv">0</span>].line_color <span class="op">=</span> <span class="st">'b'</span></span>
<span id="cb38-4"><a href="#cb38-4"></a>p[<span class="dv">1</span>].line_color <span class="op">=</span> <span class="st">'r'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="13_SymPy_files/figure-html/cell-34-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>We use the <code>plot()</code> function with the equations for the two lines but also pass two additional keyword arguments — <code>legend</code>. By setting the <code>legend</code> argument to <code>True</code>, we add a legend to the graph. <code>p[0]</code> refers to the first line, <span class="math inline">\(2x + 3\)</span>, and we set its <code>line_color</code> attribute to <code>'b'</code>, indicating that we want this line to be blue. Similarly, we set the color of the second plot to red using the string <code>'r'</code>.</p>
<p>You can even plot an implicit function using <code>plot_implicit()</code> function. For example, let’s plot the circle <span class="math inline">\(x^2 + y^2 = 1\)</span>:</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a>sp.plot_implicit(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span> <span class="op">-</span><span class="dv">1</span>, aspect_ratio<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">1</span>))<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="13_SymPy_files/figure-html/cell-35-output-1.png" class="img-fluid"></p>
</div>
</div>
<blockquote class="blockquote">
<h3 id="exercise-2-find-all-the-intersection-points-between-fx4cos3x-and-gxx3-using-sympy-by-first-plotting-the-function-and-using-the-graph-to-narrow-down-the-range-of-the-intersection-points.-then-use-nsolve-function-to-find-the-intersection-points." data-number="11.5.1" class="anchored"><span class="header-section-number">11.5.1</span> Exercise 2: Find all the intersection points between <span class="math inline">\(f(x)=4\cos(3x)\)</span> and <span class="math inline">\(g(x)=x^3\)</span> using <code>SymPy</code> by first plotting the function and using the graph to narrow down the range of the intersection points. Then, use <code>nsolve()</code> function to find the intersection points.</h3>
</blockquote>
<p>Hint: You may find <code>solve()</code> and <code>nroots()</code> can not be used to solve this problem. In addition, you may need to zoom in around 0 to find all the possible intersection points.</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># Your code here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calculus-with-sympy" class="level2" data-number="11.6">
<h2 data-number="11.6" class="anchored" data-anchor-id="calculus-with-sympy"><span class="header-section-number">11.6</span> Calculus with <code>SymPy</code></h2>
<section id="series-expansion" class="level3" data-number="11.6.1">
<h3 data-number="11.6.1" class="anchored" data-anchor-id="series-expansion"><span class="header-section-number">11.6.1</span> Series expansion</h3>
<p><code>SymPy</code> is also capable of calculating the Taylor series of an expression at a specific point. Utilize <code>series(expr, x, x0, n)</code> to determine the series expansion of <code>expr</code> around the point <code>x = x0</code> up to <code>O(x^n)</code> (where <code>n</code> is an integer):</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a>sp.series(sp.cos(x), x, <span class="dv">0</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<p><span class="math inline">\(\displaystyle 1 - \frac{x^{2}}{2} + \frac{x^{4}}{24} - \frac{x^{6}}{720} + \frac{x^{8}}{40320} + O\left(x^{10}\right)\)</span></p>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1"></a>sp.series(sp.sin(x), x, <span class="dv">0</span>, <span class="dv">10</span>).removeO()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<p><span class="math inline">\(\displaystyle \frac{x^{9}}{362880} - \frac{x^{7}}{5040} + \frac{x^{5}}{120} - \frac{x^{3}}{6} + x\)</span></p>
</div>
</div>
<p>Additionally, we can eliminate the <code>O(x^n)</code> term by applying the <code>removeO()</code> method:</p>
</section>
<section id="lambdify" class="level3" data-number="11.6.2">
<h3 data-number="11.6.2" class="anchored" data-anchor-id="lambdify"><span class="header-section-number">11.6.2</span> <code>lambdify()</code></h3>
<p>The <code>lambdify()</code> function translates <code>SymPy</code> expressions into Python functions so that they can be evaluated numerically.</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a>expr <span class="op">=</span> sp.series(sp.cos(x), x, <span class="dv">0</span>, <span class="dv">10</span>).removeO()</span>
<span id="cb43-2"><a href="#cb43-2"></a>f <span class="op">=</span> sp.utilities.lambdify(x, expr)</span>
<span id="cb43-3"><a href="#cb43-3"></a>f(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<p><span class="math inline">\(\displaystyle 1.0\)</span></p>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb44-3"><a href="#cb44-3"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>np.pi, <span class="dv">2</span><span class="op">*</span>np.pi, <span class="dv">100</span>)</span>
<span id="cb44-4"><a href="#cb44-4"></a>plt.plot(x, f(x))<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="13_SymPy_files/figure-html/cell-40-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="limits" class="level3" data-number="11.6.3">
<h3 data-number="11.6.3" class="anchored" data-anchor-id="limits"><span class="header-section-number">11.6.3</span> Limits</h3>
<p>To find limits of functions in <code>SymPy</code>, we can create objects of the <code>Limit</code> class as follows:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:487,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683281902840,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="5bfd1077-607c-445f-d49e-3ea6620d96f6" data-execution_count="42">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">'x'</span>)</span>
<span id="cb45-2"><a href="#cb45-2"></a>l <span class="op">=</span> sp.Limit(<span class="dv">1</span><span class="op">/</span>x, x, sp.oo) <span class="co"># (function, variable(symbol), limit)</span></span>
<span id="cb45-3"><a href="#cb45-3"></a>l</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<p><span class="math inline">\(\displaystyle \lim_{x \to \infty} \frac{1}{x}\)</span></p>
</div>
</div>
<p>The result is returned as an unevaluated object. To obtain the value of the limit, we can use the <code>doit()</code> method:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:582,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683281919553,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="db2e74ee-d067-4e03-e3d8-6673ccc35430" data-execution_count="43">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a>l.doit()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<p><span class="math inline">\(\displaystyle 0\)</span></p>
</div>
</div>
<p>By default, the limit is calculated from a positive direction unless the value at which the limit is to be computed is positive or negative infinity. If the limit is at positive infinity, the direction is negative, and if it is at negative infinity, the direction is positive. We can change the default direction as follows:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1499,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683281952301,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="9762539f-6322-4bc4-9f1b-ec58b3054640" data-execution_count="44">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a>sp.Limit(<span class="dv">1</span><span class="op">/</span>x, x, <span class="dv">0</span>).doit(), sp.Limit(<span class="dv">1</span><span class="op">/</span>x, x, <span class="dv">0</span>, <span class="bu">dir</span><span class="op">=</span><span class="st">'+'</span>).doit(), sp.Limit(<span class="dv">1</span><span class="op">/</span>x, x, <span class="dv">0</span>, <span class="bu">dir</span><span class="op">=</span><span class="st">'-'</span>).doit()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<p><span class="math inline">\(\displaystyle \left( \infty, \  \infty, \  -\infty\right)\)</span></p>
</div>
</div>
<p>We can change the default direction of limit calculation using the <code>dir</code> argument. The symbol <code>dir='-'</code> specifies that we are approaching the limit from the negative side. Alternatively, instead of using the <code>Limit</code> class, we can use the <code>limit()</code> function to find the limit of a function directly:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:403,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683282157789,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="9fb1aab3-e140-454e-ed34-ba007d38f93a" data-execution_count="45">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a>sp.limit(sp.sin(x)<span class="op">/</span>x, x, <span class="dv">0</span>), sp.limit((<span class="dv">1</span><span class="op">+</span><span class="dv">1</span><span class="op">/</span>x)<span class="op">**</span>x, x, sp.oo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<p><span class="math inline">\(\displaystyle \left( 1, \  e\right)\)</span></p>
</div>
</div>
</section>
<section id="finding-the-derivative-of-functions" class="level3" data-number="11.6.4">
<h3 data-number="11.6.4" class="anchored" data-anchor-id="finding-the-derivative-of-functions"><span class="header-section-number">11.6.4</span> Finding the derivative of functions</h3>
<p>To find the derivative of a function, we can create an object of <code>Derivative</code> class:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683282297837,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="961d1f1a-51a8-4029-823f-8ed7ef3f9244" data-execution_count="46">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a>t <span class="op">=</span> sp.Symbol(<span class="st">'t'</span>)</span>
<span id="cb49-2"><a href="#cb49-2"></a>St <span class="op">=</span> <span class="dv">5</span><span class="op">*</span>t<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>t <span class="op">+</span> <span class="dv">8</span></span>
<span id="cb49-3"><a href="#cb49-3"></a>sp.Derivative(St, t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<p><span class="math inline">\(\displaystyle \frac{d}{d t} \left(5 t^{2} + 2 t + 8\right)\)</span></p>
</div>
</div>
<p>Similar to the <code>Limit</code> class, when we create an object of <code>Derivative</code> class, it doesn’t calculate the derivative right away. Instead, we need to call the <code>doit()</code> method on the unevaluated <code>Derivative</code> object to evaluate and obtain the derivative:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683282334084,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="d846ceec-5a15-441d-cc49-48d086f8cd4a" data-execution_count="47">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1"></a>d <span class="op">=</span> sp.Derivative(St, t)</span>
<span id="cb50-2"><a href="#cb50-2"></a>d.doit()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<p><span class="math inline">\(\displaystyle 10 t + 2\)</span></p>
</div>
</div>
<p>If we want to calculate the value of the derivative at a specific value of <span class="math inline">\(t\)</span> such as <span class="math inline">\(t = t_1\)</span> or <span class="math inline">\(t = 1\)</span>, we can use our <code>subs()</code> method:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1066,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683282393890,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="e906d052-db3b-414e-cc2c-f1c34fef26d2" data-execution_count="48">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a>t1 <span class="op">=</span> sp.Symbol(<span class="st">'t1'</span>)</span>
<span id="cb51-2"><a href="#cb51-2"></a>d.doit().subs({t:t1}), d.doit().subs({t:<span class="dv">1</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<p><span class="math inline">\(\displaystyle \left( 10 t_{1} + 2, \  12\right)\)</span></p>
</div>
</div>
<p>Similarly, we can also use the <code>diff()</code> function to find the derivative of a function directly:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:567,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683282496393,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="323581c5-78e5-48ae-cb54-31ff3e5e8b1e" data-execution_count="49">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1"></a>sp.diff(St, t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<p><span class="math inline">\(\displaystyle 10 t + 2\)</span></p>
</div>
</div>
<p>To calculate higher derivatives, we can provide the third argument to specify the order:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1152,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683282605391,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="60f2ac80-84ad-4cd2-8876-4eb3d3adc4eb" data-execution_count="50">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1"></a>sp.diff(St, t, <span class="dv">2</span>) <span class="co"># Order equals 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<p><span class="math inline">\(\displaystyle 10\)</span></p>
</div>
</div>
</section>
<section id="finding-the-integrals-of-functions" class="level3" data-number="11.6.5">
<h3 data-number="11.6.5" class="anchored" data-anchor-id="finding-the-integrals-of-functions"><span class="header-section-number">11.6.5</span> Finding the integrals of functions</h3>
<p>We can determine either the indefinite integral (antiderivative) or the definite integral by generating an <code>Integral</code> object:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683282648112,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="c36dda31-0ea4-4ddf-99e2-41eaecc07a38" data-execution_count="54">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">'x'</span>)</span>
<span id="cb54-2"><a href="#cb54-2"></a>sp.Integral(sp.sin(x), x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<p><span class="math inline">\(\displaystyle \int \sin{\left(x \right)}\, dx\)</span></p>
</div>
</div>
<p>Just as with the <code>Limit</code> and <code>Derivative</code> classes, we can evaluate the integral by employing the <code>doit()</code> method:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683282662476,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="00451833-4b13-4efd-8370-1417d07a5125" data-execution_count="52">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1"></a>sp.Integral(sp.sin(x), x).doit()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<p><span class="math inline">\(\displaystyle - \cos{\left(x \right)}\)</span></p>
</div>
</div>
<p>Additionally, the <code>integrate()</code> function can be utilized to directly compute the integral of a given function:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683282680381,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="7250c531-95ca-4e7f-826a-9e3beb3e7cba" data-execution_count="58">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1"></a>sp.integrate(sp.sin(x), x), sp.integrate(sp.log(x), x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<p><span class="math inline">\(\displaystyle \left( - \cos{\left(x \right)}, \  x \log{\left(x \right)} - x\right)\)</span></p>
</div>
</div>
<blockquote class="blockquote">
<p>Again, it’s important to note that we should use the elementary math functions <code>sin()</code> and <code>log()</code> from the <code>SymPy</code> library in the above expression, rather than from alternative libraries such as <code>NumPy</code>.</p>
</blockquote>
<p>To calculate the definite integral, we just need to provide the variable (symbol), the lower limit, and the upper limit as a <code>tuple</code>:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:386,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683282758859,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="5dcfe0f6-eb56-4a37-957a-c6213bcf55c0" data-execution_count="59">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1"></a><span class="co"># sp.Integral(sp.sin(x), (x, 0, sp.pi / 2)).doit()</span></span>
<span id="cb57-2"><a href="#cb57-2"></a>sp.integrate(sp.sin(x), (x, <span class="dv">0</span>, sp.pi <span class="op">/</span> <span class="dv">2</span>)) <span class="co"># (function, (integration_variable, lower_limit, upper_limit))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<p><span class="math inline">\(\displaystyle 1\)</span></p>
</div>
</div>
<p>Improper integrals are supported as well:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:546,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683282774692,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="c4fa8350-4c49-4028-c587-b6e6cb7e4854" data-execution_count="60">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1"></a>sp.integrate(sp.exp(<span class="op">-</span>x), (x, <span class="dv">0</span>, sp.oo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<p><span class="math inline">\(\displaystyle 1\)</span></p>
</div>
</div>
</section>
</section>
<section id="linear-algebra-with-sympy" class="level2" data-number="11.7">
<h2 data-number="11.7" class="anchored" data-anchor-id="linear-algebra-with-sympy"><span class="header-section-number">11.7</span> Linear algebra with <code>SymPy</code></h2>
<p>Matrices can be generated as instances of the <code>Matrix</code> class:</p>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1"></a>a, b, c, x, y, z <span class="op">=</span> sp.symbols(<span class="st">'a, b, c, x, y, z'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When creating a matrix in <code>SymPy</code>, the syntax resembles that of <code>NumPy</code>: you supply a list of lists, with each list representing a row in the matrix:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:454,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683282858549,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="b4fbed71-a0da-4245-ee56-fc6bc4aef240" data-execution_count="63">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1"></a>m1 <span class="op">=</span> sp.Matrix([[a, b, c], [x, y, z], [a, b, c]])</span>
<span id="cb60-2"><a href="#cb60-2"></a>m1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<p><span class="math inline">\(\displaystyle \left[\begin{matrix}a &amp; b &amp; c\\x &amp; y &amp; z\\a &amp; b &amp; c\end{matrix}\right]\)</span></p>
</div>
</div>
<p>A matrix with <code>a, b, c</code> as diagonal elements can be constructed utilizing the <code>diag()</code> function:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:567,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683282872462,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="1c52ee4c-1bbc-42a3-ee66-10c57e2cc8c2" data-execution_count="64">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1"></a>m2 <span class="op">=</span> sp.diag(a,b,c)</span>
<span id="cb61-2"><a href="#cb61-2"></a>m2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<p><span class="math inline">\(\displaystyle \left[\begin{matrix}a &amp; 0 &amp; 0\\0 &amp; b &amp; 0\\0 &amp; 0 &amp; c\end{matrix}\right]\)</span></p>
</div>
</div>
<p>Matrix multiplication can then be performed using the <code>*</code> operator:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:579,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683282885875,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="95f6730f-cac5-4398-c507-1bf2af2bfad7" data-execution_count="65">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1"></a>m1<span class="op">*</span>m2.T <span class="co"># Instead of using @, we use * to multiply matrices</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<p><span class="math inline">\(\displaystyle \left[\begin{matrix}a^{2} &amp; b^{2} &amp; c^{2}\\a x &amp; b y &amp; c z\\a^{2} &amp; b^{2} &amp; c^{2}\end{matrix}\right]\)</span></p>
</div>
</div>
<p>Scalar multiplication and addition function as anticipated:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:386,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683282899525,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="fc7d4333-aadc-4ed5-db95-63636773d27a" data-execution_count="68">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1"></a><span class="dv">3</span><span class="op">*</span>m1 <span class="op">+</span> m2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<p><span class="math inline">\(\displaystyle \left[\begin{matrix}4 a &amp; 3 b &amp; 3 c\\3 x &amp; b + 3 y &amp; 3 z\\3 a &amp; 3 b &amp; 4 c\end{matrix}\right]\)</span></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1"></a>m1 <span class="op">+</span> <span class="dv">2</span> <span class="co"># This is not allowed since broadcasting is not directly supported</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The inverse of the matrix can be acquired using the <code>inv()</code> method:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683283053663,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="b0ff5a98-ac1a-4c46-a495-4f72b1433870" data-execution_count="69">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1"></a>m2.inv()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<p><span class="math inline">\(\displaystyle \left[\begin{matrix}\frac{1}{a} &amp; 0 &amp; 0\\0 &amp; \frac{1}{b} &amp; 0\\0 &amp; 0 &amp; \frac{1}{c}\end{matrix}\right]\)</span></p>
</div>
</div>
<p>The matrix’s eigenvalues and eigenvectors can be derived using the <code>eigenvals()</code> and <code>eigenvects()</code> methods:</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1683283049192,&quot;user&quot;:{&quot;displayName&quot;:&quot;phonchi chung&quot;,&quot;userId&quot;:&quot;13517391734500420886&quot;},&quot;user_tz&quot;:-480}" data-outputid="acb7df57-a2cd-41d4-abe0-a4524fed0fc3" data-execution_count="70">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1"></a>m2.eigenvals(), m2.eigenvects()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<p><span class="math inline">\(\displaystyle \left( \left\{ a : 1, \  b : 1, \  c : 1\right\}, \  \left[ \left( a, \  1, \  \left[ \left[\begin{matrix}1\\0\\0\end{matrix}\right]\right]\right), \  \left( b, \  1, \  \left[ \left[\begin{matrix}0\\1\\0\end{matrix}\right]\right]\right), \  \left( c, \  1, \  \left[ \left[\begin{matrix}0\\0\\1\end{matrix}\right]\right]\right)\right]\right)\)</span></p>
</div>
</div>
<p>If you would like more information about the <code>Matrix</code> class and linear algebra with SymPy, refer to the <a href="https://docs.sympy.org/latest/modules/matrices/matrices.html">official documentation</a>.</p>
<p>You can also explore the <a href="https://www.sympygamma.com/">Sympy Gamma</a> and <a href="https://live.sympy.org/">SymPy Live</a> websites to learn more about <code>SymPy</code>.</p>
<p>All in all, <code>SymPy</code> is a Python library for symbolic mathematics. It aims to provide a computer algebra system that is both easy to use and extensible. Unlike numerical libraries, which focus on approximations and numerical computations, <code>SymPy</code> is designed to perform algebraic manipulations and simplifications symbolically, allowing for exact solutions to mathematical problems.</p>
<p><code>SymPy</code> offers a wide range of features, including basic arithmetic operations, algebraic manipulation, calculus, equation solving, linear algebra, and more. It is particularly well-suited for tasks that require manipulation of symbolic expressions or solving equations symbolically.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./12_Matplotlib.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Visualization with <code>Matplotlib</code></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./00_Copilot.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Increase productivity and learning with Github Copilot in Python</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>